<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="de" xml:lang="de"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.47">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jörg Kantel">

<title>Ein kleines Planetensystem mit Proceso – Der Schockwellenreiter</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../favicon.ico" rel="icon">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Keine Treffer",
    "search-matching-documents-text": "Treffer",
    "search-copy-link-title": "Link in die Suche kopieren",
    "search-hide-matches-text": "Zusätzliche Treffer verbergen",
    "search-more-match-text": "weitere Treffer in diesem Dokument",
    "search-more-matches-text": "weitere Treffer in diesem Dokument",
    "search-clear-button-title": "Zurücksetzen",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Abbrechen",
    "search-submit-button-title": "Abschicken",
    "search-label": "Suchen"
  }
}</script>
<script data-goatcounter="https://kantel.goatcounter.com/count" async="" src="//gc.zgo.at/count.js"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Der Schockwellenreiter</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Suchen"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Navigation umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">Über den Schockwellenreiter</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/kantel/kantel.github.io"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://mastodon.social/@kantel"> <i class="bi bi-mastodon" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Ein kleines Planetensystem mit Proceso</h1>
  <div class="quarto-categories">
    <div class="quarto-category">Proceso</div>
    <div class="quarto-category">Python</div>
    <div class="quarto-category">Py5</div>
    <div class="quarto-category">PyScript</div>
    <div class="quarto-category">Processing</div>
    <div class="quarto-category">Simulation</div>
    <div class="quarto-category">Creative Coding</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Autor:in</div>
    <div class="quarto-title-meta-contents">
             <p>Jörg Kantel </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Veröffentlichungsdatum</div>
    <div class="quarto-title-meta-contents">
      <p class="date">13. Juli 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p><a href="https://www.flickr.com/photos/schockwellenreiter/54652354418/"><img src="images/planetensystem-b.jpg" class="img-fluid"></a></p>
<p>Als eines meiner nächsten Projekte mit <a href="http://cognitiones.kantel-chaos-team.de/programmierung/python/pyscript.html">PyScript</a> und <a href="https://proceso.cc/">Proceso</a> möchte ich in drei Stationen eine kleine Animation eines Planetensystems entwickeln. Dabei möchte ich zeigen, wie nützlich für solch eine Simulation die Transformationsoperatoren <code>translate()</code> und <code>rotate()</code> sein können.</p>
<section id="stage-1-ein-planet-umkreist-seine-sonne" class="level2">
<h2 class="anchored" data-anchor-id="stage-1-ein-planet-umkreist-seine-sonne">Stage 1: Ein Planet umkreist seine Sonne</h2>
<p>Ich beginne mit einem einfachem System eines Planeten, der seinen Fixstern umkreist. Der Einfachheit halber habe ich die Akteure Sonne und Erde genannt:</p>
<iframe src="proceso/stage1/index.html" width="100%" height="360">
</iframe>
<p>Zu Beginn des Sketches lege ich erst einmal ein paar Zahlen fest:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a>WIDTH, HEIGHT <span class="op">=</span> <span class="dv">640</span>, <span class="dv">360</span>   <span class="co"># Aspect Ratio: 16:9</span></span>
<span id="cb1-2"><a href="#cb1-2"></a></span>
<span id="cb1-3"><a href="#cb1-3"></a>sun_diam <span class="op">=</span> <span class="dv">80</span></span>
<span id="cb1-4"><a href="#cb1-4"></a></span>
<span id="cb1-5"><a href="#cb1-5"></a>earth_diam <span class="op">=</span> <span class="dv">30</span></span>
<span id="cb1-6"><a href="#cb1-6"></a>earth_orbit_radius <span class="op">=</span> <span class="dv">130</span></span>
<span id="cb1-7"><a href="#cb1-7"></a>earth_angle <span class="op">=</span> <span class="dv">0</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Diese Zahlen sind durch keine physikalische Wirklichkeit gedeckt, sondern einfach so lange durch Experimente herausgesucht worden, bis sie eine ansprechende Animation ergaben.</p>
<p>Die <code>setup()</code>-Funktion legt einfach nur die Größe des Ausgabefensters fest:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">def</span> setup():</span>
<span id="cb2-2"><a href="#cb2-2"></a>    p5.create_canvas(WIDTH, HEIGHT)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>In <code>draw()</code> setze ich den Hintergrund auf schwarz und dann zeichne ich die Sonne in die Mitte des Ausgabefensters:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw">def</span> draw():</span>
<span id="cb3-2"><a href="#cb3-2"></a>    <span class="kw">global</span> earth_angle</span>
<span id="cb3-3"><a href="#cb3-3"></a>    p5.background(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb3-4"><a href="#cb3-4"></a></span>
<span id="cb3-5"><a href="#cb3-5"></a>    <span class="co"># Sonne im Zentrum</span></span>
<span id="cb3-6"><a href="#cb3-6"></a>    p5.translate(p5.width<span class="op">//</span><span class="dv">2</span>, p5.height<span class="op">//</span><span class="dv">2</span>)</span>
<span id="cb3-7"><a href="#cb3-7"></a>    p5.fill(<span class="dv">255</span>, <span class="dv">200</span>, <span class="dv">64</span>)</span>
<span id="cb3-8"><a href="#cb3-8"></a>    p5.circle(<span class="dv">0</span>, <span class="dv">0</span>, sun_diam)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Die Zeile <code>p5.translate(p5.width//2, p5.height//2)</code> sorgt dafür, daß der Nullpunkt des Koordinatensystem vom linken oberen Rand in die Mitte des Ausgabefensters gelegt wird und so die Sonne mit <code>p5.circle(0, 0, sun_diam)</code> auch genau dort gezeichnet wird. Probiert es aus, der Sketch ist so lauffähig.</p>
<p>Die Variable <code>earth_angle</code> ist – wie man im Folgenden sieht – eine Variable, die sich in der <code>draw()</code>-Funktion noch ändern wird, daher muß sie leider als <code>global</code> deklariert werden<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>.</p>
<p>Nun zur Erde, die die Sonne umkreist:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a>    <span class="co"># Erde dreht sich um die Sonne</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>    p5.rotate(earth_angle)</span>
<span id="cb4-3"><a href="#cb4-3"></a>    p5.translate(earth_orbit_radius, <span class="dv">0</span>)</span>
<span id="cb4-4"><a href="#cb4-4"></a>    p5.fill(<span class="dv">64</span>, <span class="dv">64</span>, <span class="dv">255</span>)</span>
<span id="cb4-5"><a href="#cb4-5"></a>    p5.circle(<span class="dv">0</span>, <span class="dv">0</span>, earth_diam)</span>
<span id="cb4-6"><a href="#cb4-6"></a>    earth_angle <span class="op">+=</span> <span class="fl">0.01</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Wenn Ihr diese Zeilen Code in die <code>draw()</code>-Funktion unterhalb der Sonne einfügt, bekommt Ihr eine blaue Erde, die sich langsam um die Sonne bewegt. Denn mit <code>p5.translate(earth_orbit_radius, 0)</code> wurde das Koordinatensystem erneut verschoben, 130 Pixel von der Sonne entfernt aber auf der gleichen y-Achse wie das Koordinatensystem der Sonne. Da <code>p5.rotate(earth_angle)</code> vor der Koordinatentransformation aufgerufen wird, dreht sich die Erde noch um die Sonne und das Koordinatensystem der Sonne rotiert, ein <code>rotate()</code> hinter der Koordinatentransformation würde bewirken, daß sich die Erde um sich selbst dreht – das heißt, daß das Koordinatensystem der Erde rotieren würde.</p>
<p>Der vollständige Sketch sieht dann so aus:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a><span class="im">from</span> proceso <span class="im">import</span> Sketch</span>
<span id="cb5-2"><a href="#cb5-2"></a></span>
<span id="cb5-3"><a href="#cb5-3"></a>WIDTH, HEIGHT <span class="op">=</span> <span class="dv">640</span>, <span class="dv">360</span>   <span class="co"># Aspect Ratio: 16:9</span></span>
<span id="cb5-4"><a href="#cb5-4"></a></span>
<span id="cb5-5"><a href="#cb5-5"></a>sun_diam <span class="op">=</span> <span class="dv">80</span></span>
<span id="cb5-6"><a href="#cb5-6"></a></span>
<span id="cb5-7"><a href="#cb5-7"></a>earth_diam <span class="op">=</span> <span class="dv">30</span></span>
<span id="cb5-8"><a href="#cb5-8"></a>earth_orbit_radius <span class="op">=</span> <span class="dv">130</span></span>
<span id="cb5-9"><a href="#cb5-9"></a>earth_angle <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb5-10"><a href="#cb5-10"></a></span>
<span id="cb5-11"><a href="#cb5-11"></a>p5 <span class="op">=</span> Sketch()</span>
<span id="cb5-12"><a href="#cb5-12"></a></span>
<span id="cb5-13"><a href="#cb5-13"></a><span class="kw">def</span> setup():</span>
<span id="cb5-14"><a href="#cb5-14"></a>    p5.create_canvas(WIDTH, HEIGHT)</span>
<span id="cb5-15"><a href="#cb5-15"></a></span>
<span id="cb5-16"><a href="#cb5-16"></a><span class="kw">def</span> draw():</span>
<span id="cb5-17"><a href="#cb5-17"></a>    <span class="kw">global</span> earth_angle</span>
<span id="cb5-18"><a href="#cb5-18"></a>    p5.background(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb5-19"><a href="#cb5-19"></a></span>
<span id="cb5-20"><a href="#cb5-20"></a>    <span class="co"># Sonne im Zentrum</span></span>
<span id="cb5-21"><a href="#cb5-21"></a>    p5.translate(p5.width<span class="op">//</span><span class="dv">2</span>, p5.height<span class="op">//</span><span class="dv">2</span>)</span>
<span id="cb5-22"><a href="#cb5-22"></a>    p5.fill(<span class="dv">255</span>, <span class="dv">200</span>, <span class="dv">64</span>)</span>
<span id="cb5-23"><a href="#cb5-23"></a>    p5.circle(<span class="dv">0</span>, <span class="dv">0</span>, sun_diam)</span>
<span id="cb5-24"><a href="#cb5-24"></a></span>
<span id="cb5-25"><a href="#cb5-25"></a>    <span class="co"># Erde dreht sich um die Sonne</span></span>
<span id="cb5-26"><a href="#cb5-26"></a>    p5.rotate(earth_angle)</span>
<span id="cb5-27"><a href="#cb5-27"></a>    p5.translate(earth_orbit_radius, <span class="dv">0</span>)</span>
<span id="cb5-28"><a href="#cb5-28"></a>    p5.fill(<span class="dv">64</span>, <span class="dv">64</span>, <span class="dv">255</span>)</span>
<span id="cb5-29"><a href="#cb5-29"></a>    p5.circle(<span class="dv">0</span>, <span class="dv">0</span>, earth_diam)</span>
<span id="cb5-30"><a href="#cb5-30"></a>    earth_angle <span class="op">+=</span> <span class="fl">0.01</span></span>
<span id="cb5-31"><a href="#cb5-31"></a></span>
<span id="cb5-32"><a href="#cb5-32"></a>p5.run_sketch(setup<span class="op">=</span>setup, draw<span class="op">=</span>draw)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="stage-2-der-mond-dreht-sich-um-die-erde-und-beide-werden-zu-kisten" class="level2">
<h2 class="anchored" data-anchor-id="stage-2-der-mond-dreht-sich-um-die-erde-und-beide-werden-zu-kisten">Stage 2: Der Mond dreht sich um die Erde (und beide werden zu Kisten)</h2>
<iframe src="proceso/stage2/index.html" width="100%" height="360">
</iframe>
<p>Wenn ich der Erde nun noch einen Mond spendiere, brauche ich dafür natürlich auch erst einmal ein paar Parameter, die ich an den Anfang des Sketches (hinter den Parametern für die Erde) festlege:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a>moon_diam <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>moon_orbit_radius <span class="op">=</span> <span class="dv">40</span></span>
<span id="cb6-3"><a href="#cb6-3"></a>moon_angle <span class="op">=</span> <span class="dv">0</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Und die Funktion <code>draw()</code> bekommt hinter den Zeilen für die Erde noch die Zeilen für den Mond angehängt:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1"></a>    <span class="co"># Mond dreht sich um die Erde</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>    p5.rotate(moon_angle)</span>
<span id="cb7-3"><a href="#cb7-3"></a>    p5.translate(moon_orbit_radius, <span class="dv">0</span>)</span>
<span id="cb7-4"><a href="#cb7-4"></a>    p5.fill(<span class="dv">192</span>, <span class="dv">192</span>, <span class="dv">80</span>)</span>
<span id="cb7-5"><a href="#cb7-5"></a>    p5.circle(<span class="dv">0</span>, <span class="dv">0</span>, moon_diam)</span>
<span id="cb7-6"><a href="#cb7-6"></a>    moon_angle <span class="op">+=</span> <span class="fl">0.01</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Durch diese Koordinatentransformation steht der Mond im gleichen Verhältnis zur Erde wie die Erde zur Sonne, der Ursprung des Koordinatensystems liegt nun 40 Pixel vom Erdmittelpunkt entfernt. Natürlich rotiert in diesen Zeilen das Koordinatensystem der Erde, damit der Eindruck entsteht, daß der Mond um die Erde kreist.</p>
<p>Das alles funktioniert aber nur, weil bei jedem erneuten Durchlauf der <code>draw()</code>-Funktion das Koordinatensystem zurückgesetzt wird, also alle Transformationen »vergessen« werden.</p>
<p>Nun kann man bei Kreisen schwer erkennen, ob sie wirklich rotieren, daher habe ich in einer erweiterten Fassung die Kreise von Erde und Mond durch Quadrate ersetzt<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> (ich habe – damit Ihr die Position der Codezeilen finden, die ersetzte Kreisfunktion jeweils auskommentiert stehen lassen, die Rechteckfunktion wird jeweils direkt unter der auskommentierten Zeile eingefügt):</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw">def</span> draw():</span>
<span id="cb8-2"><a href="#cb8-2"></a>    <span class="kw">global</span> earth_angle, moon_angle</span>
<span id="cb8-3"><a href="#cb8-3"></a>    p5.background(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb8-4"><a href="#cb8-4"></a></span>
<span id="cb8-5"><a href="#cb8-5"></a>    <span class="co"># Sonne im Zentrum</span></span>
<span id="cb8-6"><a href="#cb8-6"></a>    p5.translate(p5.width<span class="op">//</span><span class="dv">2</span>, p5.height<span class="op">//</span><span class="dv">2</span>)</span>
<span id="cb8-7"><a href="#cb8-7"></a>    p5.fill(<span class="dv">255</span>, <span class="dv">200</span>, <span class="dv">64</span>)</span>
<span id="cb8-8"><a href="#cb8-8"></a>    p5.circle(<span class="dv">0</span>, <span class="dv">0</span>, sun_diam)</span>
<span id="cb8-9"><a href="#cb8-9"></a></span>
<span id="cb8-10"><a href="#cb8-10"></a>    <span class="co"># Erde dreht sich um die Sonne</span></span>
<span id="cb8-11"><a href="#cb8-11"></a>    p5.rotate(earth_angle)</span>
<span id="cb8-12"><a href="#cb8-12"></a>    p5.translate(earth_orbit_radius, <span class="dv">0</span>)</span>
<span id="cb8-13"><a href="#cb8-13"></a>    p5.fill(<span class="dv">64</span>, <span class="dv">64</span>, <span class="dv">255</span>)</span>
<span id="cb8-14"><a href="#cb8-14"></a>    <span class="co"># p5.circle(0, 0, earth_diam)</span></span>
<span id="cb8-15"><a href="#cb8-15"></a>    p5.rect(<span class="op">-</span>earth_diam<span class="op">//</span><span class="dv">2</span>, <span class="op">-</span>earth_diam<span class="op">//</span><span class="dv">2</span>, earth_diam, earth_diam)</span>
<span id="cb8-16"><a href="#cb8-16"></a>    earth_angle <span class="op">+=</span> <span class="fl">0.01</span></span>
<span id="cb8-17"><a href="#cb8-17"></a></span>
<span id="cb8-18"><a href="#cb8-18"></a>    <span class="co"># Mond dreht sich um die Erde</span></span>
<span id="cb8-19"><a href="#cb8-19"></a>    p5.rotate(moon_angle)</span>
<span id="cb8-20"><a href="#cb8-20"></a>    p5.translate(moon_orbit_radius, <span class="dv">0</span>)</span>
<span id="cb8-21"><a href="#cb8-21"></a>    p5.fill(<span class="dv">192</span>, <span class="dv">192</span>, <span class="dv">80</span>)</span>
<span id="cb8-22"><a href="#cb8-22"></a>    <span class="co"># p5.circle(0, 0, moon_diam)</span></span>
<span id="cb8-23"><a href="#cb8-23"></a>    p5.rect(<span class="op">-</span>moon_diam<span class="op">//</span><span class="dv">2</span>, <span class="op">-</span>moon_diam<span class="op">//</span><span class="dv">2</span>, moon_diam, moon_diam)</span>
<span id="cb8-24"><a href="#cb8-24"></a>    moon_angle <span class="op">+=</span> <span class="fl">0.01</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Da sich in <code>draw()</code> auch die Variable <code>moon_angle</code> verändert, muß auch sie als <code>global</code> deklariert werden. Der Rest des Programmes unterscheidet sich nicht von der vorherigen Fassung, daher habe ich auf einen erneuten Komplett-Abdruck verzichtet.</p>
<p>Wenn Ihr das Skript jetzt startet, dreht sich eine große blaue Kiste um die Sonne mit einer kleinen grauen Kiste, die sich um die Erde dreht und Ihr können die Rotation der beiden Kisten genau beobachten.</p>
</section>
<section id="stage-3-es-erscheint-die-nemesis" class="level2">
<h2 class="anchored" data-anchor-id="stage-3-es-erscheint-die-nemesis">Stage 3: Es erscheint die Nemesis</h2>
<iframe src="proceso/stage3/index.html" width="100%" height="360">
</iframe>
<p>Doch was ist, wenn ein zweiter Mond – nennen wir ihn als Gegenspielerin des Erdmondes einfach <em><a href="https://de.wikipedia.org/wiki/Nemesis">Nemesis</a></em> – um die Erde kreisen soll? Das Koordinatensystem der Erde ist ja schon vom Koordinatensystem des Mondes ersetzt worden. Ich brauche also eine Funktion, die das Koordinatensystem nur temporär verschiebt, so daß man auf das alte Koordinatensystem wieder zrückgreifen kann, wenn es benötigt wird. Dafür stellt Proceso das Funktionenpaar <code>push()</code> und <code>pop()</code> zur Verfügung: Mit <code>push()</code> wird das bisherige Koordinatensystem auf einen Stack gelegt und mit <code>pop()</code> wird es wieder zurückgeholt<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>.</p>
<p>Erst einmal braucht natürlich <em>Nemesis</em> ihren eigenen Satz Variablen,</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1"></a>nem_diam <span class="op">=</span> <span class="dv">12</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>nem_orbit_radius <span class="op">=</span> <span class="dv">32</span></span>
<span id="cb9-3"><a href="#cb9-3"></a>nem_angle <span class="op">=</span> <span class="dv">0</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>wobei <code>nem_angle</code> analog zu den anderen Winkeln zu Beginn der <code>draw()</code>-Schleife als <code>global</code> deklariert werden muß:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1"></a>    <span class="kw">global</span> earth_angle, moon_angle, nem_angle</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Und dann habe ich der Nemesis und dem Mond jeweils eine eigene (Koordinaten-) Matrix spendiert:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1"></a>    <span class="co"># Mond dreht sich um die Erde</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>    p5.push()</span>
<span id="cb11-3"><a href="#cb11-3"></a>    p5.rotate(moon_angle)</span>
<span id="cb11-4"><a href="#cb11-4"></a>    p5.translate(moon_orbit_radius, <span class="dv">0</span>)</span>
<span id="cb11-5"><a href="#cb11-5"></a>    p5.fill(<span class="dv">192</span>, <span class="dv">192</span>, <span class="dv">80</span>)</span>
<span id="cb11-6"><a href="#cb11-6"></a>    p5.rect(<span class="op">-</span>moon_diam<span class="op">//</span><span class="dv">2</span>, <span class="op">-</span>moon_diam<span class="op">//</span><span class="dv">2</span>, moon_diam, moon_diam)</span>
<span id="cb11-7"><a href="#cb11-7"></a>    p5.pop()</span>
<span id="cb11-8"><a href="#cb11-8"></a></span>
<span id="cb11-9"><a href="#cb11-9"></a>    <span class="co"># Nemesis dreht sich um die Erde</span></span>
<span id="cb11-10"><a href="#cb11-10"></a>    p5.push()</span>
<span id="cb11-11"><a href="#cb11-11"></a>    p5.rotate(nem_angle)</span>
<span id="cb11-12"><a href="#cb11-12"></a>    p5.translate(nem_orbit_radius, <span class="dv">0</span>)</span>
<span id="cb11-13"><a href="#cb11-13"></a>    p5.fill(<span class="dv">220</span>, <span class="dv">75</span>, <span class="dv">75</span>)</span>
<span id="cb11-14"><a href="#cb11-14"></a>    p5.rect(<span class="op">-</span>nem_diam<span class="op">//</span><span class="dv">2</span>, <span class="op">-</span>nem_diam<span class="op">//</span><span class="dv">2</span>, nem_diam, nem_diam)</span>
<span id="cb11-15"><a href="#cb11-15"></a>    p5.pop()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Und zum Schluß <code>nem_angle</code> um <span class="math inline">\(0.015\)</span> inkrementiert. Das gesamte Programm in seiner vollen Schönheit sieht nun so aus:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1"></a><span class="im">from</span> proceso <span class="im">import</span> Sketch</span>
<span id="cb12-2"><a href="#cb12-2"></a></span>
<span id="cb12-3"><a href="#cb12-3"></a>WIDTH, HEIGHT <span class="op">=</span> <span class="dv">640</span>, <span class="dv">360</span>   <span class="co"># Aspect Ratio: 16:9</span></span>
<span id="cb12-4"><a href="#cb12-4"></a></span>
<span id="cb12-5"><a href="#cb12-5"></a>sun_diam <span class="op">=</span> <span class="dv">80</span></span>
<span id="cb12-6"><a href="#cb12-6"></a></span>
<span id="cb12-7"><a href="#cb12-7"></a>earth_diam <span class="op">=</span> <span class="dv">30</span></span>
<span id="cb12-8"><a href="#cb12-8"></a>earth_orbit_radius <span class="op">=</span> <span class="dv">130</span></span>
<span id="cb12-9"><a href="#cb12-9"></a>earth_angle <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb12-10"><a href="#cb12-10"></a></span>
<span id="cb12-11"><a href="#cb12-11"></a>moon_diam <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb12-12"><a href="#cb12-12"></a>moon_orbit_radius <span class="op">=</span> <span class="dv">42</span></span>
<span id="cb12-13"><a href="#cb12-13"></a>moon_angle <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb12-14"><a href="#cb12-14"></a></span>
<span id="cb12-15"><a href="#cb12-15"></a>nem_diam <span class="op">=</span> <span class="dv">12</span></span>
<span id="cb12-16"><a href="#cb12-16"></a>nem_orbit_radius <span class="op">=</span> <span class="dv">32</span></span>
<span id="cb12-17"><a href="#cb12-17"></a>nem_angle <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb12-18"><a href="#cb12-18"></a></span>
<span id="cb12-19"><a href="#cb12-19"></a>p5 <span class="op">=</span> Sketch()</span>
<span id="cb12-20"><a href="#cb12-20"></a></span>
<span id="cb12-21"><a href="#cb12-21"></a><span class="kw">def</span> setup():</span>
<span id="cb12-22"><a href="#cb12-22"></a>    p5.create_canvas(WIDTH, HEIGHT)</span>
<span id="cb12-23"><a href="#cb12-23"></a></span>
<span id="cb12-24"><a href="#cb12-24"></a><span class="kw">def</span> draw():</span>
<span id="cb12-25"><a href="#cb12-25"></a>    <span class="kw">global</span> earth_angle, moon_angle, nem_angle</span>
<span id="cb12-26"><a href="#cb12-26"></a>    p5.background(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb12-27"><a href="#cb12-27"></a></span>
<span id="cb12-28"><a href="#cb12-28"></a>    <span class="co"># Sonne im Zentrum</span></span>
<span id="cb12-29"><a href="#cb12-29"></a>    p5.translate(p5.width<span class="op">//</span><span class="dv">2</span>, p5.height<span class="op">//</span><span class="dv">2</span>)</span>
<span id="cb12-30"><a href="#cb12-30"></a>    p5.fill(<span class="dv">255</span>, <span class="dv">200</span>, <span class="dv">64</span>)</span>
<span id="cb12-31"><a href="#cb12-31"></a>    p5.circle(<span class="dv">0</span>, <span class="dv">0</span>, sun_diam)</span>
<span id="cb12-32"><a href="#cb12-32"></a></span>
<span id="cb12-33"><a href="#cb12-33"></a>    <span class="co"># Erde dreht sich um die Sonne</span></span>
<span id="cb12-34"><a href="#cb12-34"></a>    p5.rotate(earth_angle)</span>
<span id="cb12-35"><a href="#cb12-35"></a>    p5.translate(earth_orbit_radius, <span class="dv">0</span>)</span>
<span id="cb12-36"><a href="#cb12-36"></a>    p5.fill(<span class="dv">64</span>, <span class="dv">64</span>, <span class="dv">255</span>)</span>
<span id="cb12-37"><a href="#cb12-37"></a>    <span class="co"># p5.circle(0, 0, earth_diam)</span></span>
<span id="cb12-38"><a href="#cb12-38"></a>    p5.rect(<span class="op">-</span>earth_diam<span class="op">//</span><span class="dv">2</span>, <span class="op">-</span>earth_diam<span class="op">//</span><span class="dv">2</span>, earth_diam, earth_diam)</span>
<span id="cb12-39"><a href="#cb12-39"></a></span>
<span id="cb12-40"><a href="#cb12-40"></a>    <span class="co"># Mond dreht sich um die Erde</span></span>
<span id="cb12-41"><a href="#cb12-41"></a>    p5.push()</span>
<span id="cb12-42"><a href="#cb12-42"></a>    p5.rotate(moon_angle)</span>
<span id="cb12-43"><a href="#cb12-43"></a>    p5.translate(moon_orbit_radius, <span class="dv">0</span>)</span>
<span id="cb12-44"><a href="#cb12-44"></a>    p5.fill(<span class="dv">192</span>, <span class="dv">192</span>, <span class="dv">80</span>)</span>
<span id="cb12-45"><a href="#cb12-45"></a>    p5.rect(<span class="op">-</span>moon_diam<span class="op">//</span><span class="dv">2</span>, <span class="op">-</span>moon_diam<span class="op">//</span><span class="dv">2</span>, moon_diam, moon_diam)</span>
<span id="cb12-46"><a href="#cb12-46"></a>    p5.pop()</span>
<span id="cb12-47"><a href="#cb12-47"></a></span>
<span id="cb12-48"><a href="#cb12-48"></a>    <span class="co"># Nemesis dreht sich um die Erde</span></span>
<span id="cb12-49"><a href="#cb12-49"></a>    p5.push()</span>
<span id="cb12-50"><a href="#cb12-50"></a>    p5.rotate(nem_angle)</span>
<span id="cb12-51"><a href="#cb12-51"></a>    p5.translate(nem_orbit_radius, <span class="dv">0</span>)</span>
<span id="cb12-52"><a href="#cb12-52"></a>    p5.fill(<span class="dv">220</span>, <span class="dv">75</span>, <span class="dv">75</span>)</span>
<span id="cb12-53"><a href="#cb12-53"></a>    p5.rect(<span class="op">-</span>nem_diam<span class="op">//</span><span class="dv">2</span>, <span class="op">-</span>nem_diam<span class="op">//</span><span class="dv">2</span>, nem_diam, nem_diam)</span>
<span id="cb12-54"><a href="#cb12-54"></a>    p5.pop()</span>
<span id="cb12-55"><a href="#cb12-55"></a>    </span>
<span id="cb12-56"><a href="#cb12-56"></a>    earth_angle <span class="op">+=</span> <span class="fl">0.01</span></span>
<span id="cb12-57"><a href="#cb12-57"></a>    moon_angle <span class="op">+=</span> <span class="fl">0.01</span></span>
<span id="cb12-58"><a href="#cb12-58"></a>    nem_angle <span class="op">+=</span> <span class="fl">0.015</span></span>
<span id="cb12-59"><a href="#cb12-59"></a></span>
<span id="cb12-60"><a href="#cb12-60"></a>p5.run_sketch(setup<span class="op">=</span>setup, draw<span class="op">=</span>draw)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Natürlich hätte man sich bei der <em>Nemesis</em> das <code>push()</code>- und <code>pop()</code>-Paar sparen können, aber so ist es sauberer und Ihr könnt der Erde noch einen dritten und einen vierten Trabanten spendieren, ohne mit den Koordinatensystemen durcheinander zu geraten.</p>
<p>Wenn Ihr Euch das Programm anschaut, werdet Ihr sehen, warum ich für die Erde und ihre Trabanten Rechtecke gewählt habe. So ist zu erkennen, daß die Erde mit genau einer Seite immer zur Sonne zeigt und die beiden Trabanten ebenfalls mit genau einer Seite zur Erde. Das ist, weil sie sich jeweils in ihrem eigenen Koordinatensystem bewegen, dessen eine Achse immer das Zentrum des darüberliegenden Koordinatensystems schneidet.</p>
<p>Für die Monde ist das okay, wenn Ihr der Erde aber Tag und Nacht spendieren wollt, müsst Ihr ihr noch ein zweites <code>rotate()</code> <strong>nach</strong> der Koordinatentransformation spendieren.</p>
<p>Wie immer ist das Progrämmchen ausbaubar. Ihr könnt zum Beispiel mehrere Planeten jeweils mit ihren eigenen Koordinatensystemen um den Fixstern kreisen lassen. Alle diese Planeten könnt Ihr mit beliebig vielen Monden umgeben, die alle wiederum ihr eigenes Koordinatensystem besitzen. Und wenn Ihr wirkliche Heroinnen oder Helden sein wollt: Schnappt Euch ein Buch mit den <a href="https://de.wikipedia.org/wiki/Keplersche_Gesetze">Keplerschen Gesetzen zur Planetenbewegung</a> und simuliert damit ein realistischeres Planetensystem.</p>
</section>
<section id="literatur" class="level2">
<h2 class="anchored" data-anchor-id="literatur">Literatur</h2>
<p>Die Idee zu diesem Sketch und einige der Parameter habe ich dem wunderbaren Buch »Processing for Visual Artists – How to Create Expressive Images and Interactive Art«, Natick, MA (A K Peters) 2010, von <em>Andrew Glassner</em>, Seiten 192-200 entnommen und von Java nach Python portiert.</p>
<hr>
<p><strong>Bild</strong>: <em><a href="https://www.flickr.com/photos/schockwellenreiter/54652354418/">Planetenbeobachter</a></em>, erstellt mit <a href="https://openart.ai/home">OpenArt.ai</a>. Prompt: »<em>Colored Franco-Belgian comic style: A green python with glasses and a rabbit stand on a distant planet, observing the night sky. The rabbit wears a dark blue vest and holds a large pocket watch. A few planets with their moons and gray clouds can be seen in the sky. A planetary base and two spaceships stand in the landscape</em>«. Modell: Flux (Pro), Style: None.</p>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Fußnoten</h2>

<ol>
<li id="fn1"><p>Eigentlich versuche ich ja, <code>global</code>-Deklarationen zu vermeiden, aber in diesem Falle ist sie – glaube ich – vertretbar.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Ich weiß, Planeten sind meist kugelförmig und keine Kisten, aber in der virtuellen Welt von Proceso ist alles möglich.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Leider kennt Proceso dafür nicht das pythonische <code>with push():</code>-Statement, das die Befehle für das neue Koordinatensystem durch Einrücken klammern und so das jeweilige <code>pop()</code> überflüssig machen würde.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Kopiert");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Kopiert");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/kantel\.github\.io\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="kantel/kantel.github.io" data-repo-id="R_kgDOIjiXMQ" data-category="General" data-category-id="DIC_kwDOIjiXMc4CS_hh" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script>
<input type="hidden" id="giscus-base-theme" value="light">
<input type="hidden" id="giscus-alt-theme" value="dark">
</div> <!-- /content -->




</body></html>