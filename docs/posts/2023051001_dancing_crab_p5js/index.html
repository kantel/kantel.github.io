<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="de" xml:lang="de"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.340">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jörg Kantel">

<title>Der Schockwellenreiter - Dancing Crab mit P5.js</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../favicon.ico" rel="icon">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "Keine Treffer",
    "search-matching-documents-text": "Treffer",
    "search-copy-link-title": "Link in die Suche kopieren",
    "search-hide-matches-text": "Zusätzliche Treffer verbergen",
    "search-more-match-text": "weitere Treffer in diesem Dokument",
    "search-more-matches-text": "weitere Treffer in diesem Dokument",
    "search-clear-button-title": "Zurücksetzen",
    "search-detached-cancel-button-title": "Abbrechen",
    "search-submit-button-title": "Abschicken"
  }
}</script>
<script data-goatcounter="https://kantel.goatcounter.com/count" async="" src="//gc.zgo.at/count.js"></script>
<script src="./js/p5.min.js"></script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Der Schockwellenreiter</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Suchen"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Navigation umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">Über den Schockwellenreiter</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/kantel/kantel.github.io" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://mastodon.social/@kantel" rel="" target=""><i class="bi bi-mastodon" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml" rel="" target=""><i class="bi bi-rss" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">
<script src="./sketch.js"></script>

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Dancing Crab mit P5.js</h1>
  <div class="quarto-categories">
    <div class="quarto-category">P5.js</div>
    <div class="quarto-category">Spieleprogrammierung</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Autor:in</div>
    <div class="quarto-title-meta-contents">
             <p>Jörg Kantel </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Veröffentlichungsdatum</div>
    <div class="quarto-title-meta-contents">
      <p class="date">10. Mai 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://www.flickr.com/photos/schockwellenreiter/52884361756/"><img src="images/dancingcrabp5js_banner-b.jpg" class="img-fluid figure-img"></a></p>
</figure>
</div>
<p>Yeah, I did it! Ich habe mein erstes, eigenes Spiel in <a href="http://cognitiones.kantel-chaos-team.de/programmierung/creativecoding/processing/p5js.html">P5.js</a> programmiert. Eigentlich habe ich »nur« meine <a href="https://kantel.github.io/posts/2023041403_dancing_crab_3/">kleine, rote und mit Luftblasen tanzende Krabbe</a> von Python (<a href="http://cognitiones.kantel-chaos-team.de/programmierung/python/trinket.html">Trinket</a>) nach JavaScript (P5.js) portiert. Es war einerseits einfacher, als ich dachte, andererseits gab es doch einige Probleme, an denen ich zu knabbern hatte, die aber größtenteils meiner fehlenden JavaScript-Erfahrung zuzuschreiben waren.</p>
<p>Die größten Probleme verursachten jedoch nicht die ungewohnte Syntax (an <code>for (let item of items)</code> statt <code>for item in items</code> oder <code>this.</code> statt <code>self.</code> hatte ich mich schnell gewöhnt) oder die geschweiften Klammerns, sondern die Semikolon (<code>;</code>) am Ende jeder Zeile. Wie oft ich mich verfluchte, weil ich diese mal wieder vergessen hatte, kann ich gar nicht zählen.</p>
<div id="crab01">

</div>
<p>Die wichtigste Änderung gegenüber der Trinket-Python-Version ist, daß die Krabbe nun nicht mehr mit der rechten oder linken Maustaste, sondern mit den rechten und linken Pfeiltasten gesteuert wird. Damit diese nicht auch noch an den Browser durchgereicht werden, habe ich sie am Ende der Funktionen <code>keyPressed()</code> und <code>keyReleased()</code> jeweils mit einem <code>return false</code> abgefangen und neutralisiert.</p>
<p>Und die Krabbe zappelt nun nicht mehr ununterbrochen, sondern tänzelt nur noch, wenn sie sich bewegt.</p>
<p>Außerdem kann in der derzeitigen Version die Krabbe noch nicht sterben und das Spiel beendet werden, da dann ein Reload der gesamten Seite erforderlich wäre, um ein neues Spiel zu starten. (In einer – geplanten – späteren Version werde ich verschiedene Spiel-Statii mit einem Restart-Screen einbauen, aber jetzt ist das erst einmal nur ein <em>proof of concept</em>.) Zwar wird eine Kollision der Krabbe mit einer roten Blase mit einem »GAME OVER« kommentiert (nur bei eingschalteter JavaScript-Konsole sichtbar), doch ansonsten geht das Spiel ungerührt weiter.</p>
<p>Ansonsten sind sich JavaScript in der ES6-Variante und Python sehr ähnlich. Wer sich überzeugen will, kann ja den Quellcode meiner P5.js-Version mit der <a href="https://kantel.github.io/posts/2023041403_dancing_crab_3/">Original-Python-Version</a> vergleichen:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource javascript number-lines code-with-copy"><code class="sourceCode javascript"><span id="cb1-1"><a href="#cb1-1"></a><span class="co">// Dancing Crab</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="co">// Jörg Kantel 2023</span></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="kw">const</span> windowWidth <span class="op">=</span> <span class="dv">640</span><span class="op">;</span></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="kw">const</span> windowHeight <span class="op">=</span> <span class="dv">416</span><span class="op">;</span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="kw">const</span> fps <span class="op">=</span> <span class="dv">60</span><span class="op">;</span></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="kw">const</span> numBubbles <span class="op">=</span> <span class="dv">50</span><span class="op">;</span></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="kw">const</span> numEnemies <span class="op">=</span> <span class="dv">5</span><span class="op">;</span></span>
<span id="cb1-8"><a href="#cb1-8"></a></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="kw">let</span> bg<span class="op">;</span></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="kw">let</span> crab<span class="op">;</span></span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="kw">let</span> crabImages <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="kw">let</span> bubbles <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="kw">let</span> bubbleImages <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb1-14"><a href="#cb1-14"></a><span class="kw">let</span> enemyBubbles <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb1-15"><a href="#cb1-15"></a><span class="kw">let</span> enemyImage<span class="op">;</span></span>
<span id="cb1-16"><a href="#cb1-16"></a></span>
<span id="cb1-17"><a href="#cb1-17"></a><span class="kw">class</span> Crab {</span>
<span id="cb1-18"><a href="#cb1-18"></a></span>
<span id="cb1-19"><a href="#cb1-19"></a>  <span class="fu">constructor</span>() {</span>
<span id="cb1-20"><a href="#cb1-20"></a>    <span class="kw">this</span><span class="op">.</span><span class="at">w</span> <span class="op">=</span> <span class="dv">64</span><span class="op">;</span></span>
<span id="cb1-21"><a href="#cb1-21"></a>    <span class="kw">this</span><span class="op">.</span><span class="at">h</span> <span class="op">=</span> <span class="dv">64</span><span class="op">;</span></span>
<span id="cb1-22"><a href="#cb1-22"></a>    <span class="kw">this</span><span class="op">.</span><span class="at">r</span> <span class="op">=</span> <span class="dv">32</span><span class="op">;</span></span>
<span id="cb1-23"><a href="#cb1-23"></a>    <span class="kw">this</span><span class="op">.</span><span class="at">x</span> <span class="op">=</span> width<span class="op">/</span><span class="dv">2</span> <span class="op">-</span> <span class="kw">this</span><span class="op">.</span><span class="at">w</span><span class="op">/</span><span class="dv">2</span><span class="op">;</span></span>
<span id="cb1-24"><a href="#cb1-24"></a>    <span class="kw">this</span><span class="op">.</span><span class="at">y</span> <span class="op">=</span> height<span class="op">/</span><span class="dv">2</span> <span class="op">+</span> <span class="dv">100</span><span class="op">;</span></span>
<span id="cb1-25"><a href="#cb1-25"></a>    <span class="kw">this</span><span class="op">.</span><span class="at">img</span> <span class="op">=</span> crabImages[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb1-26"><a href="#cb1-26"></a>    <span class="kw">this</span><span class="op">.</span><span class="at">dir</span> <span class="op">=</span> <span class="st">"none"</span><span class="op">;</span></span>
<span id="cb1-27"><a href="#cb1-27"></a>    <span class="kw">this</span><span class="op">.</span><span class="at">speed</span> <span class="op">=</span> <span class="dv">5</span><span class="op">;</span></span>
<span id="cb1-28"><a href="#cb1-28"></a>    <span class="kw">this</span><span class="op">.</span><span class="at">animationCount</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb1-29"><a href="#cb1-29"></a>    <span class="kw">this</span><span class="op">.</span><span class="at">score</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb1-30"><a href="#cb1-30"></a>  }</span>
<span id="cb1-31"><a href="#cb1-31"></a></span>
<span id="cb1-32"><a href="#cb1-32"></a>  <span class="fu">update</span>() {</span>
<span id="cb1-33"><a href="#cb1-33"></a>    <span class="co">// Bewegung</span></span>
<span id="cb1-34"><a href="#cb1-34"></a>    <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">dir</span> <span class="op">==</span> <span class="st">"none"</span>) {</span>
<span id="cb1-35"><a href="#cb1-35"></a>      <span class="kw">this</span><span class="op">.</span><span class="at">x</span> <span class="op">+=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb1-36"><a href="#cb1-36"></a>    } <span class="cf">else</span> <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">dir</span> <span class="op">==</span> <span class="st">"right"</span>) {</span>
<span id="cb1-37"><a href="#cb1-37"></a>      <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">x</span> <span class="op">&lt;=</span> width <span class="op">-</span> <span class="kw">this</span><span class="op">.</span><span class="at">w</span> <span class="op">-</span> <span class="dv">5</span>) {</span>
<span id="cb1-38"><a href="#cb1-38"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">x</span> <span class="op">+=</span> <span class="kw">this</span><span class="op">.</span><span class="at">speed</span><span class="op">;</span></span>
<span id="cb1-39"><a href="#cb1-39"></a>      }</span>
<span id="cb1-40"><a href="#cb1-40"></a>    } <span class="cf">else</span> <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">dir</span> <span class="op">==</span> <span class="st">"left"</span>) {</span>
<span id="cb1-41"><a href="#cb1-41"></a>      <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">x</span> <span class="op">&gt;=</span> <span class="dv">2</span>) {</span>
<span id="cb1-42"><a href="#cb1-42"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">x</span> <span class="op">-=</span> <span class="kw">this</span><span class="op">.</span><span class="at">speed</span><span class="op">;</span></span>
<span id="cb1-43"><a href="#cb1-43"></a>      }</span>
<span id="cb1-44"><a href="#cb1-44"></a>    }</span>
<span id="cb1-45"><a href="#cb1-45"></a>    <span class="co">// Animation</span></span>
<span id="cb1-46"><a href="#cb1-46"></a>    <span class="kw">this</span><span class="op">.</span><span class="at">animationCount</span> <span class="op">+=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb1-47"><a href="#cb1-47"></a>    <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">dir</span> <span class="op">==</span> <span class="st">"none"</span>) {</span>
<span id="cb1-48"><a href="#cb1-48"></a>      <span class="kw">this</span><span class="op">.</span><span class="at">img</span> <span class="op">=</span> crabImages[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb1-49"><a href="#cb1-49"></a>    } <span class="cf">else</span> {</span>
<span id="cb1-50"><a href="#cb1-50"></a>    <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">animationCount</span> <span class="op">&gt;=</span> <span class="dv">10</span>) {</span>
<span id="cb1-51"><a href="#cb1-51"></a>      <span class="kw">this</span><span class="op">.</span><span class="at">animationCount</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb1-52"><a href="#cb1-52"></a>    }</span>
<span id="cb1-53"><a href="#cb1-53"></a>    <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">animationCount</span> <span class="op">&lt;=</span> <span class="dv">5</span>) {</span>
<span id="cb1-54"><a href="#cb1-54"></a>      <span class="kw">this</span><span class="op">.</span><span class="at">img</span> <span class="op">=</span> crabImages[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb1-55"><a href="#cb1-55"></a>    } <span class="cf">else</span> {</span>
<span id="cb1-56"><a href="#cb1-56"></a>      <span class="kw">this</span><span class="op">.</span><span class="at">img</span> <span class="op">=</span> crabImages[<span class="dv">1</span>]<span class="op">;</span></span>
<span id="cb1-57"><a href="#cb1-57"></a>    }</span>
<span id="cb1-58"><a href="#cb1-58"></a>  }</span>
<span id="cb1-59"><a href="#cb1-59"></a>  }</span>
<span id="cb1-60"><a href="#cb1-60"></a></span>
<span id="cb1-61"><a href="#cb1-61"></a>  <span class="fu">display</span>() {</span>
<span id="cb1-62"><a href="#cb1-62"></a>    <span class="fu">image</span>(<span class="kw">this</span><span class="op">.</span><span class="at">img</span><span class="op">,</span> <span class="kw">this</span><span class="op">.</span><span class="at">x</span><span class="op">,</span> <span class="kw">this</span><span class="op">.</span><span class="at">y</span>)<span class="op">;</span></span>
<span id="cb1-63"><a href="#cb1-63"></a>  }</span>
<span id="cb1-64"><a href="#cb1-64"></a>}</span>
<span id="cb1-65"><a href="#cb1-65"></a></span>
<span id="cb1-66"><a href="#cb1-66"></a><span class="kw">class</span> Bubble {</span>
<span id="cb1-67"><a href="#cb1-67"></a></span>
<span id="cb1-68"><a href="#cb1-68"></a>  <span class="fu">constructor</span>() {</span>
<span id="cb1-69"><a href="#cb1-69"></a>    <span class="kw">this</span><span class="op">.</span><span class="fu">reset</span>()<span class="op">;</span></span>
<span id="cb1-70"><a href="#cb1-70"></a>    <span class="kw">this</span><span class="op">.</span><span class="at">speed</span> <span class="op">=</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb1-71"><a href="#cb1-71"></a>  }</span>
<span id="cb1-72"><a href="#cb1-72"></a></span>
<span id="cb1-73"><a href="#cb1-73"></a>  <span class="fu">reset</span>() {</span>
<span id="cb1-74"><a href="#cb1-74"></a>    <span class="kw">let</span> dia <span class="op">=</span> <span class="fu">int</span>(<span class="fu">random</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">2</span>))</span>
<span id="cb1-75"><a href="#cb1-75"></a>    <span class="kw">this</span><span class="op">.</span><span class="at">img</span> <span class="op">=</span> bubbleImages[dia]<span class="op">;</span></span>
<span id="cb1-76"><a href="#cb1-76"></a>    <span class="kw">this</span><span class="op">.</span><span class="at">r</span> <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">img</span><span class="op">.</span><span class="at">width</span><span class="op">/</span><span class="dv">2</span><span class="op">;</span></span>
<span id="cb1-77"><a href="#cb1-77"></a>    <span class="kw">this</span><span class="op">.</span><span class="at">x</span> <span class="op">=</span> <span class="fu">int</span>(<span class="fu">random</span>(width))<span class="op">;</span></span>
<span id="cb1-78"><a href="#cb1-78"></a>    <span class="kw">this</span><span class="op">.</span><span class="at">y</span> <span class="op">=</span> <span class="fu">int</span>(<span class="fu">random</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>height<span class="op">,</span> <span class="op">-</span><span class="dv">50</span>))<span class="op">;</span></span>
<span id="cb1-79"><a href="#cb1-79"></a>  }</span>
<span id="cb1-80"><a href="#cb1-80"></a></span>
<span id="cb1-81"><a href="#cb1-81"></a>  <span class="fu">isCircleCollision</span>(other) {</span>
<span id="cb1-82"><a href="#cb1-82"></a>    <span class="kw">let</span> distance <span class="op">=</span> <span class="fu">dist</span>(<span class="kw">this</span><span class="op">.</span><span class="at">x</span><span class="op">,</span> <span class="kw">this</span><span class="op">.</span><span class="at">y</span><span class="op">,</span> other<span class="op">.</span><span class="at">x</span><span class="op">,</span> other<span class="op">.</span><span class="at">y</span>)<span class="op">;</span></span>
<span id="cb1-83"><a href="#cb1-83"></a>    <span class="cf">if</span> (distance <span class="op">&lt;</span> <span class="kw">this</span><span class="op">.</span><span class="at">r</span> <span class="op">+</span> other<span class="op">.</span><span class="at">r</span>) {</span>
<span id="cb1-84"><a href="#cb1-84"></a>      <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb1-85"><a href="#cb1-85"></a>    }</span>
<span id="cb1-86"><a href="#cb1-86"></a>    <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb1-87"><a href="#cb1-87"></a>  }</span>
<span id="cb1-88"><a href="#cb1-88"></a></span>
<span id="cb1-89"><a href="#cb1-89"></a>  <span class="fu">update</span>() {</span>
<span id="cb1-90"><a href="#cb1-90"></a>    <span class="kw">this</span><span class="op">.</span><span class="at">y</span> <span class="op">+=</span> <span class="kw">this</span><span class="op">.</span><span class="at">speed</span><span class="op">;</span></span>
<span id="cb1-91"><a href="#cb1-91"></a>    <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">y</span> <span class="op">&gt;</span> height <span class="op">+</span> <span class="dv">50</span>) {</span>
<span id="cb1-92"><a href="#cb1-92"></a>      <span class="kw">this</span><span class="op">.</span><span class="fu">reset</span>()<span class="op">;</span></span>
<span id="cb1-93"><a href="#cb1-93"></a>    }</span>
<span id="cb1-94"><a href="#cb1-94"></a>  }</span>
<span id="cb1-95"><a href="#cb1-95"></a></span>
<span id="cb1-96"><a href="#cb1-96"></a>  <span class="fu">display</span>() {</span>
<span id="cb1-97"><a href="#cb1-97"></a>    <span class="fu">image</span>(<span class="kw">this</span><span class="op">.</span><span class="at">img</span><span class="op">,</span> <span class="kw">this</span><span class="op">.</span><span class="at">x</span><span class="op">,</span> <span class="kw">this</span><span class="op">.</span><span class="at">y</span>)<span class="op">;</span></span>
<span id="cb1-98"><a href="#cb1-98"></a>  }</span>
<span id="cb1-99"><a href="#cb1-99"></a>}</span>
<span id="cb1-100"><a href="#cb1-100"></a></span>
<span id="cb1-101"><a href="#cb1-101"></a><span class="kw">class</span> EnemyBubble <span class="kw">extends</span> Bubble {</span>
<span id="cb1-102"><a href="#cb1-102"></a></span>
<span id="cb1-103"><a href="#cb1-103"></a>  <span class="fu">constructor</span>() {</span>
<span id="cb1-104"><a href="#cb1-104"></a>    <span class="kw">super</span>()<span class="op">;</span></span>
<span id="cb1-105"><a href="#cb1-105"></a>    <span class="kw">this</span><span class="op">.</span><span class="fu">reset</span>()<span class="op">;</span></span>
<span id="cb1-106"><a href="#cb1-106"></a>    <span class="kw">this</span><span class="op">.</span><span class="at">r</span> <span class="op">=</span> <span class="dv">15</span><span class="op">;</span></span>
<span id="cb1-107"><a href="#cb1-107"></a>    <span class="kw">this</span><span class="op">.</span><span class="at">speed</span> <span class="op">=</span> <span class="dv">3</span><span class="op">;</span></span>
<span id="cb1-108"><a href="#cb1-108"></a>    <span class="kw">this</span><span class="op">.</span><span class="at">img</span> <span class="op">=</span> enemyImage<span class="op">;</span></span>
<span id="cb1-109"><a href="#cb1-109"></a>  }</span>
<span id="cb1-110"><a href="#cb1-110"></a></span>
<span id="cb1-111"><a href="#cb1-111"></a>    <span class="fu">reset</span>() {</span>
<span id="cb1-112"><a href="#cb1-112"></a>      <span class="kw">this</span><span class="op">.</span><span class="at">x</span> <span class="op">=</span> <span class="fu">int</span>(<span class="fu">random</span>(width))<span class="op">;</span></span>
<span id="cb1-113"><a href="#cb1-113"></a>      <span class="kw">this</span><span class="op">.</span><span class="at">y</span> <span class="op">=</span> <span class="fu">int</span>(<span class="fu">random</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>height<span class="op">,</span> <span class="op">-</span><span class="dv">50</span>))<span class="op">;</span></span>
<span id="cb1-114"><a href="#cb1-114"></a>    }</span>
<span id="cb1-115"><a href="#cb1-115"></a>  }</span>
<span id="cb1-116"><a href="#cb1-116"></a></span>
<span id="cb1-117"><a href="#cb1-117"></a><span class="kw">function</span> <span class="fu">preload</span>() {</span>
<span id="cb1-118"><a href="#cb1-118"></a>  bg <span class="op">=</span> <span class="fu">loadImage</span>(<span class="st">"images/background.png"</span>)<span class="op">;</span></span>
<span id="cb1-119"><a href="#cb1-119"></a>  crabImages[<span class="dv">0</span>] <span class="op">=</span> <span class="fu">loadImage</span>(<span class="st">"images/crab1.png"</span>)<span class="op">;</span></span>
<span id="cb1-120"><a href="#cb1-120"></a>  crabImages[<span class="dv">1</span>] <span class="op">=</span> <span class="fu">loadImage</span>(<span class="st">"images/crab2.png"</span>)<span class="op">;</span></span>
<span id="cb1-121"><a href="#cb1-121"></a>  <span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">3</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb1-122"><a href="#cb1-122"></a>    bubbleImages[i] <span class="op">=</span> <span class="fu">loadImage</span>(<span class="st">"images/bubbleblue"</span> <span class="op">+</span> <span class="fu">str</span>(i) <span class="op">+</span> <span class="st">".png"</span>)<span class="op">;</span> </span>
<span id="cb1-123"><a href="#cb1-123"></a>  }</span>
<span id="cb1-124"><a href="#cb1-124"></a>  enemyImage <span class="op">=</span> <span class="fu">loadImage</span>(<span class="st">"images/bubblere1.png"</span>)<span class="op">;</span></span>
<span id="cb1-125"><a href="#cb1-125"></a>}</span>
<span id="cb1-126"><a href="#cb1-126"></a></span>
<span id="cb1-127"><a href="#cb1-127"></a><span class="kw">function</span> <span class="fu">setup</span>() {</span>
<span id="cb1-128"><a href="#cb1-128"></a>  myCanvas <span class="op">=</span> <span class="fu">createCanvas</span>(windowWidth<span class="op">,</span> windowHeight)<span class="op">;</span></span>
<span id="cb1-129"><a href="#cb1-129"></a>  myCanvas<span class="op">.</span><span class="fu">parent</span>(<span class="st">"crab01"</span>)<span class="op">;</span></span>
<span id="cb1-130"><a href="#cb1-130"></a>  <span class="fu">frameRate</span>(fps)<span class="op">;</span></span>
<span id="cb1-131"><a href="#cb1-131"></a>  <span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> numBubbles<span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb1-132"><a href="#cb1-132"></a>    bubbles[i] <span class="op">=</span> <span class="kw">new</span> Bubble<span class="op">;</span></span>
<span id="cb1-133"><a href="#cb1-133"></a>  }</span>
<span id="cb1-134"><a href="#cb1-134"></a>  <span class="cf">for</span> (<span class="kw">let</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> numEnemies<span class="op">;</span> j<span class="op">++</span>) {</span>
<span id="cb1-135"><a href="#cb1-135"></a>    enemyBubbles[j] <span class="op">=</span> <span class="kw">new</span> EnemyBubble<span class="op">;</span></span>
<span id="cb1-136"><a href="#cb1-136"></a>  }</span>
<span id="cb1-137"><a href="#cb1-137"></a>  crab <span class="op">=</span> <span class="kw">new</span> <span class="fu">Crab</span>()<span class="op">;</span></span>
<span id="cb1-138"><a href="#cb1-138"></a>}</span>
<span id="cb1-139"><a href="#cb1-139"></a></span>
<span id="cb1-140"><a href="#cb1-140"></a><span class="kw">function</span> <span class="fu">draw</span>() {</span>
<span id="cb1-141"><a href="#cb1-141"></a>  <span class="fu">background</span>(<span class="dv">49</span><span class="op">,</span> <span class="dv">197</span><span class="op">,</span> <span class="dv">244</span>)<span class="op">;</span>    <span class="co">// Hellblau</span></span>
<span id="cb1-142"><a href="#cb1-142"></a>  <span class="fu">image</span>(bg<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb1-143"><a href="#cb1-143"></a>  <span class="cf">for</span> (<span class="kw">let</span> bubble <span class="kw">of</span> bubbles) {</span>
<span id="cb1-144"><a href="#cb1-144"></a>    bubble<span class="op">.</span><span class="fu">update</span>()<span class="op">;</span></span>
<span id="cb1-145"><a href="#cb1-145"></a>    <span class="cf">if</span> (bubble<span class="op">.</span><span class="fu">isCircleCollision</span>(crab)) {</span>
<span id="cb1-146"><a href="#cb1-146"></a>      bubble<span class="op">.</span><span class="fu">reset</span>()<span class="op">;</span></span>
<span id="cb1-147"><a href="#cb1-147"></a>      crab<span class="op">.</span><span class="at">score</span> <span class="op">+=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb1-148"><a href="#cb1-148"></a>      <span class="co">// console.log(crab.score);</span></span>
<span id="cb1-149"><a href="#cb1-149"></a>    }</span>
<span id="cb1-150"><a href="#cb1-150"></a>    bubble<span class="op">.</span><span class="fu">display</span>()<span class="op">;</span></span>
<span id="cb1-151"><a href="#cb1-151"></a>  }</span>
<span id="cb1-152"><a href="#cb1-152"></a>  <span class="cf">for</span> (enemyBubble <span class="kw">of</span> enemyBubbles) {</span>
<span id="cb1-153"><a href="#cb1-153"></a>    enemyBubble<span class="op">.</span><span class="fu">update</span>()<span class="op">;</span></span>
<span id="cb1-154"><a href="#cb1-154"></a>    <span class="cf">if</span> (enemyBubble<span class="op">.</span><span class="fu">isCircleCollision</span>(crab)) {</span>
<span id="cb1-155"><a href="#cb1-155"></a>      <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="st">"GAME OVER"</span>)<span class="op">;</span></span>
<span id="cb1-156"><a href="#cb1-156"></a>      <span class="co">// crab.x = 2000;</span></span>
<span id="cb1-157"><a href="#cb1-157"></a>      <span class="co">// crab.y = 2000;</span></span>
<span id="cb1-158"><a href="#cb1-158"></a>    }</span>
<span id="cb1-159"><a href="#cb1-159"></a>    enemyBubble<span class="op">.</span><span class="fu">display</span>()<span class="op">;</span></span>
<span id="cb1-160"><a href="#cb1-160"></a>  }</span>
<span id="cb1-161"><a href="#cb1-161"></a>  crab<span class="op">.</span><span class="fu">update</span>()<span class="op">;</span></span>
<span id="cb1-162"><a href="#cb1-162"></a>  crab<span class="op">.</span><span class="fu">display</span>()<span class="op">;</span></span>
<span id="cb1-163"><a href="#cb1-163"></a>}</span>
<span id="cb1-164"><a href="#cb1-164"></a></span>
<span id="cb1-165"><a href="#cb1-165"></a><span class="kw">function</span> <span class="fu">keyPressed</span>() {</span>
<span id="cb1-166"><a href="#cb1-166"></a>  <span class="cf">if</span> (keyCode <span class="op">===</span> LEFT_ARROW) {</span>
<span id="cb1-167"><a href="#cb1-167"></a>    crab<span class="op">.</span><span class="at">dir</span> <span class="op">=</span> <span class="st">"left"</span><span class="op">;</span></span>
<span id="cb1-168"><a href="#cb1-168"></a>  } <span class="cf">else</span> <span class="cf">if</span> (keyCode <span class="op">===</span> RIGHT_ARROW) {</span>
<span id="cb1-169"><a href="#cb1-169"></a>    crab<span class="op">.</span><span class="at">dir</span> <span class="op">=</span> <span class="st">"right"</span><span class="op">;</span></span>
<span id="cb1-170"><a href="#cb1-170"></a>  }</span>
<span id="cb1-171"><a href="#cb1-171"></a>  <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb1-172"><a href="#cb1-172"></a>}</span>
<span id="cb1-173"><a href="#cb1-173"></a></span>
<span id="cb1-174"><a href="#cb1-174"></a><span class="kw">function</span> <span class="fu">keyReleased</span>() {</span>
<span id="cb1-175"><a href="#cb1-175"></a>  crab<span class="op">.</span><span class="at">dir</span> <span class="op">=</span> <span class="st">"none"</span><span class="op">;</span></span>
<span id="cb1-176"><a href="#cb1-176"></a>  <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb1-177"><a href="#cb1-177"></a>}</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Wie gewohnt gibt es den <a href="https://github.com/kantel/p5js/tree/master/dancingcrab">Quellcode mit allen Assets</a> in meinem GitHub-Repositorium. Dazu hier auch noch die Credits: Die Impementierung wurde inspiriert von <em>Heiko Fehrs</em> »<a href="http://www.letscode-python.de/buch.php">Let’s Code Python</a>«, Bonn (Rheinwerk-Verlag) 2019, Seiten 247ff. Die Bilder der Krabbe sind von <em>Nitin Chowdary</em>, der sie unter der CC0 auf <a href="https://opengameart.org/content/crab">OpenGameArt.org veröffentlicht</a> hatte. Ebenfalls von OpenGameArt.org sind die <a href="https://opengameart.org/content/bubbles8-colors">Luftblasen</a> (CC-BY 3.0) des Users mit dem schönen Screen-Namen <em>HorrorPen</em>. Und der Bildhintergrund stammt wie so oft aus dem schier unerschöpflichen, freien (CC0) <a href="https://www.kenney.nl/assets/fish-pack">Fundus von Kenny.nl</a>.</p>
<p>Das Spielen mit P5.js hat mir sehr viel Spaß bereitet. Es wird daher vermutlich in Zukunft mehr davon geben. Macht Euch auf einiges gefaßt, ich habe Blut geleckt. <em>Still digging!</em></p>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Kopiert");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Kopiert");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="kantel/kantel.github.io" data-repo-id="R_kgDOIjiXMQ" data-category="General" data-category-id="DIC_kwDOIjiXMc4CS_hh" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->



</body></html>