<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="de" xml:lang="de"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.47">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jörg Kantel">

<title>Shaun das Schaf und seine Spießgesellen: Eine Simulation in vier Schritten – Der Schockwellenreiter</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../favicon.ico" rel="icon">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Keine Treffer",
    "search-matching-documents-text": "Treffer",
    "search-copy-link-title": "Link in die Suche kopieren",
    "search-hide-matches-text": "Zusätzliche Treffer verbergen",
    "search-more-match-text": "weitere Treffer in diesem Dokument",
    "search-more-matches-text": "weitere Treffer in diesem Dokument",
    "search-clear-button-title": "Zurücksetzen",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Abbrechen",
    "search-submit-button-title": "Abschicken",
    "search-label": "Suchen"
  }
}</script>
<script data-goatcounter="https://kantel.goatcounter.com/count" async="" src="//gc.zgo.at/count.js"></script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Der Schockwellenreiter</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Suchen"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Navigation umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">Über den Schockwellenreiter</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/kantel/kantel.github.io"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://mastodon.social/@kantel"> <i class="bi bi-mastodon" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Shaun das Schaf und seine Spießgesellen: Eine Simulation in vier Schritten</h1>
  <div class="quarto-categories">
    <div class="quarto-category">Python</div>
    <div class="quarto-category">PyScript</div>
    <div class="quarto-category">Proseco</div>
    <div class="quarto-category">Simulation</div>
    <div class="quarto-category">Creative Coding</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Autor:in</div>
    <div class="quarto-title-meta-contents">
             <p>Jörg Kantel </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Veröffentlichungsdatum</div>
    <div class="quarto-title-meta-contents">
      <p class="date">6. Juli 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p><a href="https://www.flickr.com/photos/schockwellenreiter/54637186835/"><img src="images/shaun-b.jpg" class="img-fluid"></a></p>
<p>Nachdem die Installation (via <code>pypi</code>) von <a href="http://cognitiones.kantel-chaos-team.de/programmierung/creativecoding/processing/pyp5js.html">pyp5js</a> bei mir gewaltig schiefgelaufen war (<code>werkzeug</code> konnte irgendeine URL-Bibliothek nicht finden), habe ich beschlossen, mich für Python-Projekte (außer Spielen), <a href="https://kantel.github.io/posts/2025062901_proseco_first_steps/">die im Browser laufen sollen</a>, erst einmal auf <a href="http://cognitiones.kantel-chaos-team.de/programmierung/python/pyscript.html">PyScript</a> mit <a href="https://proceso.cc/">Proseco</a> zu beschränken. Als ersten echten Testfall habe ich mir dann ein Projekt herausgesucht, das ich schon im März&nbsp;2019 einmal in <a href="http://cognitiones.kantel-chaos-team.de/programmierung/creativecoding/processing/processingpy.html">Processing.py</a> programmiert hatte: <a href="http://blog.schockwellenreiter.de/2019/03/2019031001.html">Shaun das Schaf und seine Spießgesellen</a>.</p>
<p>Es basiert auf dem »Crazy Sheep Programm«, das <em>Peter Farell</em> in seinem wunderbaren Buch »<a href="https://nostarch.com/mathadventures">Math Adventures with Python</a>« ebenfalls in Processing.py implementiert hatte (Seiten 186ff.). Ich habe die Reimplementierung in Proseco in vier Schritte aufgeteilt. Aber erst einmal galt es, ein einfaches Proseco-Grundgerüst (ein <em>Boilerplate</em>) zu erstellen (Datei <code>sketch.py</code>):</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="im">from</span> proceso <span class="im">import</span> Sketch</span>
<span id="cb1-2"><a href="#cb1-2"></a></span>
<span id="cb1-3"><a href="#cb1-3"></a>p5 <span class="op">=</span> Sketch()</span>
<span id="cb1-4"><a href="#cb1-4"></a></span>
<span id="cb1-5"><a href="#cb1-5"></a>WIDTH, HEIGHT <span class="op">=</span> (<span class="dv">640</span>, <span class="dv">400</span>)</span>
<span id="cb1-6"><a href="#cb1-6"></a>FPS <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb1-7"><a href="#cb1-7"></a></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="kw">def</span> setup():</span>
<span id="cb1-9"><a href="#cb1-9"></a>    p5.create_canvas(WIDTH, HEIGHT)</span>
<span id="cb1-10"><a href="#cb1-10"></a>    p5.frame_rate(FPS)</span>
<span id="cb1-11"><a href="#cb1-11"></a></span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="kw">def</span> draw():</span>
<span id="cb1-13"><a href="#cb1-13"></a>    p5.background(GREEN)</span>
<span id="cb1-14"><a href="#cb1-14"></a></span>
<span id="cb1-15"><a href="#cb1-15"></a>p5.run_sketch(setup<span class="op">=</span>setup, draw<span class="op">=</span>draw)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Da die Simulation nachvollziehbar bleiben sollte, habe ich die Simulation auf fünf Schritte in der Sekunde gedrosselt:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a>FPS <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>p5.frame_rate(FPS)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Die übrigen Dateien (<code>index.html</code>, <code>pyscript.json</code> und <code>style.css</code>) können genauso <a href="https://kantel.github.io/posts/2025062901_proseco_first_steps/">wie in meinem ersten Versuch</a> unverändert übernommen werden (eventuell den <code>title</code> in der <code>index.html</code> anpassen).</p>
<section id="schritt-1-shaun-das-schaf-betritt-die-bühne" class="level2">
<h2 class="anchored" data-anchor-id="schritt-1-shaun-das-schaf-betritt-die-bühne">Schritt 1: Shaun das Schaf betritt die Bühne</h2>
<p>Im ersten Schritt wollte ich nur <a href="https://de.wikipedia.org/wiki/Shaun_das_Schaf">Shaun das Schaf</a> auf eine grüne Wiese schicken. Daher habe ich den Schafen erst einmal eine eigene Klasse (<code>Sheep</code>) spendiert:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw">class</span> Sheep:</span>
<span id="cb3-2"><a href="#cb3-2"></a></span>
<span id="cb3-3"><a href="#cb3-3"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, _x, _y):</span>
<span id="cb3-4"><a href="#cb3-4"></a>        <span class="va">self</span>.x <span class="op">=</span> _x</span>
<span id="cb3-5"><a href="#cb3-5"></a>        <span class="va">self</span>.y <span class="op">=</span> _y</span>
<span id="cb3-6"><a href="#cb3-6"></a>        <span class="va">self</span>.size <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb3-7"><a href="#cb3-7"></a></span>
<span id="cb3-8"><a href="#cb3-8"></a>   <span class="kw">def</span> update(<span class="va">self</span>):</span>
<span id="cb3-9"><a href="#cb3-9"></a>        move <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb3-10"><a href="#cb3-10"></a>        <span class="va">self</span>.x <span class="op">+=</span> uniform(<span class="op">-</span>move, move)</span>
<span id="cb3-11"><a href="#cb3-11"></a>        <span class="va">self</span>.y <span class="op">+=</span> uniform(<span class="op">-</span>move, move)</span>
<span id="cb3-12"><a href="#cb3-12"></a>        <span class="va">self</span>.check_border()</span>
<span id="cb3-13"><a href="#cb3-13"></a>    </span>
<span id="cb3-14"><a href="#cb3-14"></a>    <span class="kw">def</span> check_border(<span class="va">self</span>):</span>
<span id="cb3-15"><a href="#cb3-15"></a>        <span class="cf">if</span> <span class="va">self</span>.x <span class="op">&gt;=</span> p5.width <span class="op">-</span> <span class="dv">2</span><span class="op">*</span><span class="va">self</span>.size:</span>
<span id="cb3-16"><a href="#cb3-16"></a>            <span class="va">self</span>.x <span class="op">=</span> p5.width <span class="op">-</span> <span class="dv">2</span><span class="op">*</span><span class="va">self</span>.size</span>
<span id="cb3-17"><a href="#cb3-17"></a>        <span class="cf">if</span> <span class="va">self</span>.y <span class="op">&gt;=</span> p5.height <span class="op">-</span> <span class="dv">2</span><span class="op">*</span><span class="va">self</span>.size:</span>
<span id="cb3-18"><a href="#cb3-18"></a>            <span class="va">self</span>.y <span class="op">=</span> p5.height <span class="op">-</span> <span class="dv">2</span><span class="op">*</span><span class="va">self</span>.size</span>
<span id="cb3-19"><a href="#cb3-19"></a>        <span class="cf">if</span> <span class="va">self</span>.x <span class="op">&lt;=</span> <span class="va">self</span>.size:</span>
<span id="cb3-20"><a href="#cb3-20"></a>            <span class="va">self</span>.x <span class="op">=</span> <span class="va">self</span>.size</span>
<span id="cb3-21"><a href="#cb3-21"></a>        <span class="cf">if</span> <span class="va">self</span>.y <span class="op">&lt;=</span> <span class="va">self</span>.size:</span>
<span id="cb3-22"><a href="#cb3-22"></a>            <span class="va">self</span>.y <span class="op">=</span> <span class="va">self</span>.size</span>
<span id="cb3-23"><a href="#cb3-23"></a>    </span>
<span id="cb3-24"><a href="#cb3-24"></a>    <span class="kw">def</span> draw(<span class="va">self</span>):</span>
<span id="cb3-25"><a href="#cb3-25"></a>        p5.stroke_weight(<span class="dv">1</span>)</span>
<span id="cb3-26"><a href="#cb3-26"></a>        p5.stroke(BLACK)</span>
<span id="cb3-27"><a href="#cb3-27"></a>        p5.circle(<span class="va">self</span>.x, <span class="va">self</span>.y, <span class="va">self</span>.size)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Die <code>update()</code>-Methode ist sehr einfach gehalten: Das Schaf (eigentlich ein Kreis) bewegt sich bei jedem Zeitschritt zufällig zwischen -10 und 10 Pixeln in x- und y-Richtung weiter und wenn es auf den Rand des Bildschirms trifft, muss es dort verharren, bis der Zufallszahlengenerator ihm eine neue Bewegung in eine andere Richtung zuweist, die es auf ein anderes Feld innerhalb der Weide (des Fensters) führt (Methode <code>check_border()</code>).</p>
<p>Dann bekommt das Programm noch ein paar (Farb-) Konstanten verpasst</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a>WHITE  <span class="op">=</span> p5.color(<span class="dv">255</span>, <span class="dv">255</span>, <span class="dv">255</span>)</span>
<span id="cb4-2"><a href="#cb4-2"></a>BLACK  <span class="op">=</span> p5.color(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb4-3"><a href="#cb4-3"></a>GREEN  <span class="op">=</span> p5.color(<span class="dv">98</span>, <span class="dv">199</span>, <span class="dv">119</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>und in den <code>setup()</code>- und <code>draw()</code>-Methoden wird das Schaf erzeugt und auf die Reise geschickt:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw">def</span> setup():</span>
<span id="cb5-2"><a href="#cb5-2"></a>    <span class="kw">global</span> shaun</span>
<span id="cb5-3"><a href="#cb5-3"></a>    p5.create_canvas(WIDTH, HEIGHT)</span>
<span id="cb5-4"><a href="#cb5-4"></a>    <span class="co"># Create the sheeps</span></span>
<span id="cb5-5"><a href="#cb5-5"></a>    shaun <span class="op">=</span> Sheep(<span class="dv">320</span>, <span class="dv">200</span>)</span>
<span id="cb5-6"><a href="#cb5-6"></a>    p5.frame_rate(FPS)</span>
<span id="cb5-7"><a href="#cb5-7"></a></span>
<span id="cb5-8"><a href="#cb5-8"></a><span class="kw">def</span> draw():</span>
<span id="cb5-9"><a href="#cb5-9"></a>    p5.background(GREEN)</span>
<span id="cb5-10"><a href="#cb5-10"></a>    shaun.update()</span>
<span id="cb5-11"><a href="#cb5-11"></a>    shaun.draw()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Das häßliche <code>global</code> in <code>setup()</code> können wir im nächsten Schritt wieder eliminieren.</p>
<p>Wenn Ihr das Script laufen laßt, werden Ihr sehen, daß wirklich noch nicht viel passiert: Ein weißer Kreis irrt ziellos über eine grüne Ebene. Das ist alles.</p>
</section>
<section id="scnritt-2-vom-schaf-zur-schafherde" class="level2">
<h2 class="anchored" data-anchor-id="scnritt-2-vom-schaf-zur-schafherde">Scnritt 2: Vom Schaf zur Schafherde</h2>
<p>Das ändert sich jedoch massiv mit der zweiten Version des Programms. Doch zuerst einmal habe ich dem Hauptscript noch ein paar Importe von Zufallszahlengeneratoren und dann die Konstanten <code>PATCH_SIZE</code> (dazu später mehr) und <code>NO_SHEEPS</code>, sowie die Farbe <code>BROWN</code> spendiert:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a><span class="im">from</span> proceso <span class="im">import</span> Sketch</span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="im">from</span> random <span class="im">import</span> uniform, randint</span>
<span id="cb6-3"><a href="#cb6-3"></a></span>
<span id="cb6-4"><a href="#cb6-4"></a>p5 <span class="op">=</span> Sketch()</span>
<span id="cb6-5"><a href="#cb6-5"></a></span>
<span id="cb6-6"><a href="#cb6-6"></a>WIDTH, HEIGHT <span class="op">=</span> (<span class="dv">640</span>, <span class="dv">400</span>)</span>
<span id="cb6-7"><a href="#cb6-7"></a>FPS <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb6-8"><a href="#cb6-8"></a>NO_SHEEPS <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb6-9"><a href="#cb6-9"></a>PATCH_SIZE <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb6-10"><a href="#cb6-10"></a></span>
<span id="cb6-11"><a href="#cb6-11"></a><span class="co"># Farben</span></span>
<span id="cb6-12"><a href="#cb6-12"></a>WHITE  <span class="op">=</span> p5.color(<span class="dv">255</span>, <span class="dv">255</span>, <span class="dv">255</span>)</span>
<span id="cb6-13"><a href="#cb6-13"></a>BLACK  <span class="op">=</span> p5.color(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb6-14"><a href="#cb6-14"></a>BROWN  <span class="op">=</span> p5.color(<span class="dv">248</span>, <span class="dv">158</span>, <span class="dv">80</span>)</span>
<span id="cb6-15"><a href="#cb6-15"></a>GREEN  <span class="op">=</span> p5.color(<span class="dv">98</span>, <span class="dv">199</span>, <span class="dv">119</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Neu ist auch die Klasse <code>Grass</code>, denn die Schafe sollen es abweiden können und hinterlassen dann eine abgeweidete, also braune Schafweide. Jedes mal, wenn ein Schaf einen »Patch« Gras abfrißt, bekommt es fünf Energiepunkte spendiert. Daher sieht diese Klasse so aus:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw">class</span> Grass:</span>
<span id="cb7-2"><a href="#cb7-2"></a></span>
<span id="cb7-3"><a href="#cb7-3"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, _x, _y, _size):</span>
<span id="cb7-4"><a href="#cb7-4"></a>        <span class="va">self</span>.x <span class="op">=</span> _x</span>
<span id="cb7-5"><a href="#cb7-5"></a>        <span class="va">self</span>.y <span class="op">=</span> _y</span>
<span id="cb7-6"><a href="#cb7-6"></a>        <span class="va">self</span>.energy <span class="op">=</span> <span class="dv">5</span>      <span class="co"># Energy from eating this patch</span></span>
<span id="cb7-7"><a href="#cb7-7"></a>        <span class="va">self</span>.eaten <span class="op">=</span> <span class="va">False</span>   <span class="co"># Hasn't been eaten yet</span></span>
<span id="cb7-8"><a href="#cb7-8"></a>        <span class="va">self</span>.size <span class="op">=</span> _size</span>
<span id="cb7-9"><a href="#cb7-9"></a>    </span>
<span id="cb7-10"><a href="#cb7-10"></a>    <span class="kw">def</span> draw(<span class="va">self</span>):</span>
<span id="cb7-11"><a href="#cb7-11"></a>        p5.no_stroke()</span>
<span id="cb7-12"><a href="#cb7-12"></a>        <span class="cf">if</span> <span class="va">self</span>.eaten:</span>
<span id="cb7-13"><a href="#cb7-13"></a>            p5.fill(BROWN)</span>
<span id="cb7-14"><a href="#cb7-14"></a>        <span class="cf">else</span>:</span>
<span id="cb7-15"><a href="#cb7-15"></a>            p5.fill(GREEN)</span>
<span id="cb7-16"><a href="#cb7-16"></a>        p5.rect(<span class="va">self</span>.x, <span class="va">self</span>.y, <span class="va">self</span>.size, <span class="va">self</span>.size)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Die meisten Änderungen gibt es aber in der Klasse <code>Sheep</code>, die ja nun eine ganze Schafherde hervorbringen soll:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw">class</span> Sheep:</span>
<span id="cb8-2"><a href="#cb8-2"></a></span>
<span id="cb8-3"><a href="#cb8-3"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, _x, _y):</span>
<span id="cb8-4"><a href="#cb8-4"></a>        <span class="va">self</span>.x <span class="op">=</span> _x</span>
<span id="cb8-5"><a href="#cb8-5"></a>        <span class="va">self</span>.y <span class="op">=</span> _y</span>
<span id="cb8-6"><a href="#cb8-6"></a>        <span class="va">self</span>.size <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb8-7"><a href="#cb8-7"></a>        <span class="va">self</span>.energy <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb8-8"><a href="#cb8-8"></a></span>
<span id="cb8-9"><a href="#cb8-9"></a>    <span class="kw">def</span> update(<span class="va">self</span>):</span>
<span id="cb8-10"><a href="#cb8-10"></a>        move <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb8-11"><a href="#cb8-11"></a>        rows_of_grass <span class="op">=</span> p5.height<span class="op">//</span>PATCH_SIZE</span>
<span id="cb8-12"><a href="#cb8-12"></a>        <span class="va">self</span>.x <span class="op">+=</span> uniform(<span class="op">-</span>move, move)</span>
<span id="cb8-13"><a href="#cb8-13"></a>        <span class="va">self</span>.y <span class="op">+=</span> uniform(<span class="op">-</span>move, move)</span>
<span id="cb8-14"><a href="#cb8-14"></a>        <span class="va">self</span>.check_border()</span>
<span id="cb8-15"><a href="#cb8-15"></a>        x_scale <span class="op">=</span> <span class="bu">int</span>(<span class="va">self</span>.x<span class="op">/</span>PATCH_SIZE)</span>
<span id="cb8-16"><a href="#cb8-16"></a>        y_scale <span class="op">=</span> <span class="bu">int</span>(<span class="va">self</span>.y<span class="op">/</span>PATCH_SIZE)</span>
<span id="cb8-17"><a href="#cb8-17"></a>        grass <span class="op">=</span> lawn[x_scale<span class="op">*</span>rows_of_grass <span class="op">+</span> y_scale]</span>
<span id="cb8-18"><a href="#cb8-18"></a>        <span class="cf">if</span> <span class="kw">not</span> grass.eaten:</span>
<span id="cb8-19"><a href="#cb8-19"></a>            <span class="va">self</span>.energy <span class="op">+=</span> grass.energy</span>
<span id="cb8-20"><a href="#cb8-20"></a>            grass.eaten <span class="op">=</span> <span class="va">True</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Die Methoden <code>check_border()</code> und <code>draw()</code> der Klasse <code>Sheep</code> bleiben unverändert.</p>
<p>Was hat sich denn nun geändert? Zum einen bekommt jedes Schaf mit <code>self.energy = 20</code> eine Startenergie von 20 Punkten zugewiesen. Zum anderen bekommt jedes Schaf bei jedem Zeitschritt einen Energiepunkt abgezogen. Energie auftanken kann es nur, wenn es Gras frißt, denn Gras fressen soll sich schließlich wieder lohnen.</p>
<p>Aber es gilt noch ein anderes Problem zu berücksichtigen: Der Zufallszahlengenerator führt die Schafe nicht eindeutig auf ein Patchfeld mit Gras, da mußte ich dann ein wenig runden: Erstens ist die Weide in einem eindimensionalen Array abgespeichert, daher habe ich in der <code>update()</code>-Methode mit</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1"></a>        rows_of_grass <span class="op">=</span> p5.height<span class="op">//</span>PATCH_SIZE</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>erst einmal die Reihen des Feldes ermittelt. Damit auch immer eine Ganzzahl herauskommt, habe ich den Integer-Divisions-Operator <code>//</code> verwendet. Und dann habe ich mit</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1"></a>        x_scale <span class="op">=</span> <span class="bu">int</span>(<span class="va">self</span>.x<span class="op">/</span>PATCH_SIZE)</span>
<span id="cb10-2"><a href="#cb10-2"></a>        y_scale <span class="op">=</span> <span class="bu">int</span>(<span class="va">self</span>.y<span class="op">/</span>PATCH_SIZE)</span>
<span id="cb10-3"><a href="#cb10-3"></a>        grass <span class="op">=</span> lawn[x_scale<span class="op">*</span>rows_of_grass <span class="op">+</span> y_scale]</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>dafür gesorgt, daß jedem Schaf immer der am nächsten gelegene Graspatch zum Abweiden zugewiesen wird. (Erfahrenen Processing-Programmierern wird dies aus der Bildverarbeitung bekannt vorkommen, da Processing auch Bilder immer als eindimensionale Arrays abspeichert und man so mit der gleichen Methode die x- und y-Koordinaten eines Bildes berechnen muß.)</p>
<p>Ja, was noch? Wenn der Rasenpatch abgeweidet ist, bekommt das Schaf fünf Energiepunkte spendiert und der Weidepatch eine braune Farbe zugewiesen.</p>
<p>(Patches als eigene Objekte (und Agenten) hat meines Wissens als erster <em>Mitchel Resnick</em> 1994 in <a href="http://cognitiones.kantel-chaos-team.de/programmierung/starlogo.html">StarLogo</a> implementiert und in seinem Buch »Turtles, Termites, and Traffic Jams« vorgestellt.)</p>
<p>Die <code>setup()</code>- und die <code>draw()</code>-Methode des Hauptscripts haben auch ein paar einschneidende Veränderungen erfahren:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1"></a>sheeps <span class="op">=</span> []</span>
<span id="cb11-2"><a href="#cb11-2"></a>lawn <span class="op">=</span> []</span>
<span id="cb11-3"><a href="#cb11-3"></a></span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="kw">def</span> setup():</span>
<span id="cb11-5"><a href="#cb11-5"></a>    p5.create_canvas(WIDTH, HEIGHT)</span>
<span id="cb11-6"><a href="#cb11-6"></a>    <span class="co"># Create the sheeps</span></span>
<span id="cb11-7"><a href="#cb11-7"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(NO_SHEEPS):</span>
<span id="cb11-8"><a href="#cb11-8"></a>        sheeps.append(Sheep(randint(<span class="dv">20</span>, p5.width <span class="op">-</span> <span class="dv">20</span>),</span>
<span id="cb11-9"><a href="#cb11-9"></a>                            randint(<span class="dv">20</span>, p5.height <span class="op">-</span> <span class="dv">20</span>)))</span>
<span id="cb11-10"><a href="#cb11-10"></a>    <span class="co"># Create the grass</span></span>
<span id="cb11-11"><a href="#cb11-11"></a>    <span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, p5.width, PATCH_SIZE):</span>
<span id="cb11-12"><a href="#cb11-12"></a>        <span class="cf">for</span> y <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, p5.height, PATCH_SIZE):</span>
<span id="cb11-13"><a href="#cb11-13"></a>            lawn.append(Grass(x, y, PATCH_SIZE))</span>
<span id="cb11-14"><a href="#cb11-14"></a>    p5.frame_rate(FPS)</span>
<span id="cb11-15"><a href="#cb11-15"></a></span>
<span id="cb11-16"><a href="#cb11-16"></a><span class="kw">def</span> draw():</span>
<span id="cb11-17"><a href="#cb11-17"></a>    p5.background(GREEN)</span>
<span id="cb11-18"><a href="#cb11-18"></a>    <span class="co"># Update the grass first</span></span>
<span id="cb11-19"><a href="#cb11-19"></a>    <span class="cf">for</span> grass <span class="kw">in</span> lawn:</span>
<span id="cb11-20"><a href="#cb11-20"></a>        grass.draw()</span>
<span id="cb11-21"><a href="#cb11-21"></a>    <span class="co"># then the sheeps    </span></span>
<span id="cb11-22"><a href="#cb11-22"></a>    <span class="cf">for</span> sheep <span class="kw">in</span> sheeps:</span>
<span id="cb11-23"><a href="#cb11-23"></a>        sheep.update()</span>
<span id="cb11-24"><a href="#cb11-24"></a>        sheep.draw()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Einmal ist durch die Deklaration der Listen für die Schafe (<code>sheeps[]</code>) und des Rasens (<code>lawn[]</code>) wie versprochen die ungeliebte <code>global</code>-Vereinbarung entfallen. Und dann werden die beiden Listen in der <code>setup()</code>-Methode gefüllt, wobei der Rasen zwar mit x- und y-Komponenten, aber dennoch in einer eindimensionalen Liste abgespeichert wird.</p>
<p>Da die Schafe sich ungehindert vermehren können, wird irgendwann die Weide zwar abgefressen, aber dennoch überfüllt sein. Darum möchte ich in der nächsten Version dieses Programmes nicht nur das Nachwachsen des Grases simulieren, sondern energiegeladene Schafe sollen sich auch reproduzieren, also vermehren können, aber wenn sie zuwenig Nahrung bekommen, müssen die Schafe leider verhungern.</p>
</section>
<section id="schritt-3-geburt-und-tod" class="level2">
<h2 class="anchored" data-anchor-id="schritt-3-geburt-und-tod">Schritt 3: Geburt und Tod</h2>
<p>Diesen Abschnitt kann ich erst einmal mit einer guten Nachricht einleiten: Im Hauptprogramm ändert sich nichts und die Klasse <code>Sheep</code> wird nur minimal verändert, und zwar bekommt die <code>update()</code>-Methode Routinen verpasst, die einmal das Verhungern kontrollieren und dann steuern, wie sich die Schafe vermehren:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1"></a>    <span class="kw">def</span> update(<span class="va">self</span>):</span>
<span id="cb12-2"><a href="#cb12-2"></a>        move <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb12-3"><a href="#cb12-3"></a>        rows_of_grass <span class="op">=</span> p5.height<span class="op">//</span>PATCH_SIZE</span>
<span id="cb12-4"><a href="#cb12-4"></a>        <span class="va">self</span>.energy <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb12-5"><a href="#cb12-5"></a>        <span class="cf">if</span> <span class="va">self</span>.energy <span class="op">&lt;=</span> <span class="dv">0</span>:</span>
<span id="cb12-6"><a href="#cb12-6"></a>            sheeps.remove(<span class="va">self</span>)</span>
<span id="cb12-7"><a href="#cb12-7"></a>        <span class="cf">if</span> <span class="va">self</span>.energy <span class="op">&gt;=</span> <span class="dv">50</span>:</span>
<span id="cb12-8"><a href="#cb12-8"></a>            <span class="va">self</span>.energy <span class="op">-=</span> <span class="dv">30</span>   <span class="co"># Giving birth takes energy</span></span>
<span id="cb12-9"><a href="#cb12-9"></a>            <span class="co"># Add another sheep to the list</span></span>
<span id="cb12-10"><a href="#cb12-10"></a>            sheeps.append(Sheep(<span class="va">self</span>.x, <span class="va">self</span>.y, <span class="va">self</span>.col))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Denn hier wird einmal festgelegt, daß Schafe verhungern (aus der Liste mit mit <code>sheeps.remove(self)</code> entfernt werden) und zum anderen, daß ein Schaf, das einen Energielevel von 50 Punkten oder mehr besitzt, sich vermehren soll. Dieser Vorgang kostet dem Tier zwar 30 Energiepunkte, aber dafür hat es sich quasi verdoppelt. Das neue Schaf wird auf der gleichen Position geboren, auf der sein Elternschaf sitzt, aber der Zufallszahlengenerator sorgt schnell dafür, daß beide Tiere bald getrennte Wege gehen.</p>
<p>Die zweite Änderung betrifft die <code>draw()</code>-Methode der Klasse <code>Grass</code>:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1"></a>    <span class="kw">def</span> draw(<span class="va">self</span>):</span>
<span id="cb13-2"><a href="#cb13-2"></a>        p5.no_stroke()</span>
<span id="cb13-3"><a href="#cb13-3"></a>        <span class="cf">if</span> <span class="va">self</span>.eaten:</span>
<span id="cb13-4"><a href="#cb13-4"></a>            <span class="cf">if</span> uniform(<span class="dv">0</span>, <span class="dv">100</span>) <span class="op">&lt;</span> <span class="fl">.5</span>:</span>
<span id="cb13-5"><a href="#cb13-5"></a>                <span class="va">self</span>.eaten <span class="op">=</span> <span class="va">False</span></span>
<span id="cb13-6"><a href="#cb13-6"></a>            <span class="cf">else</span>:</span>
<span id="cb13-7"><a href="#cb13-7"></a>                p5.fill(BROWN)</span>
<span id="cb13-8"><a href="#cb13-8"></a>        <span class="cf">else</span>:</span>
<span id="cb13-9"><a href="#cb13-9"></a>            p5.fill(GREEN)</span>
<span id="cb13-10"><a href="#cb13-10"></a>        p5.rect(<span class="va">self</span>.x, <span class="va">self</span>.y, <span class="va">self</span>.size, <span class="va">self</span>.size)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Hier wird mit einer Wahrscheinlichkeit von 5 Promille dem Gras die Chance gegeben, wieder zu wachsen, das heißt einen Patch wieder grün und abweidbar werden zu lassen.</p>
<p>Diese geringe Wahrscheinlichkeit reicht aus. Wenn Ihr die Simulation über einen längeren Zeitraum laufen lasst, werdet Ihr feststellen, daß die Schafspopulation mit den gegebenen Parametern stabil bleibt (die Parameter habe ich durch wildes Experimentieren herausgefunden). Sie kann zwar mal – vornehmlich zu Beginn, wenn alles noch grün ist – sehr groß werden oder im weiteren Verlauf auch sehr klein (unter zehn Schafe), aber sie stirbt fast nie mehr aus, sondern die Population pendelt immer um einen Mittelwert herum. In einigen, seltenen Fällen – wenn der Zufall die überlebenden Schafe nur auf abgeweidete Flächen führt – kann auch die gesamte Population aussterben, da müßte man dann noch ein wenig an den Energieparametern schrauben.</p>
<p>Dieses Verhalten ist aus ähnlichen <a href="https://de.wikipedia.org/wiki/R%C3%A4uber-Beute-Beziehung">Räuber- und Beute-Simulationen</a> bekannt (ich ernenne die Schafe jetzt einfach mal zu gefährlichen Raubtieren ehrenhalber und das Gras zu ihrer Beute) und wird nach ihren Entdeckern <a href="https://de.wikipedia.org/wiki/Lotka-Volterra-Regeln">Lotka-Volterra-Regeln</a>, beziehungsweise mathematisch präzise <a href="https://de.wikipedia.org/wiki/Lotka-Volterra-Gleichungen">Lotka-Volterra-Gleichungen</a> genannt.</p>
</section>
<section id="schrtt-4-es-kann-nur-einen-eine-farbe-geben" class="level2">
<h2 class="anchored" data-anchor-id="schrtt-4-es-kann-nur-einen-eine-farbe-geben">Schrtt 4: Es kann nur einen (eine Farbe) geben!</h2>
<p>Als abschließende Änderung habe ich die Schafe in vier unterschiedlich farbige Varianten aufgeteilt, während das sonstige Verhalten unverändert geblieben ist. Daher sind noch ein paar weitere Farbdefinitionen hinzugekommen</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1"></a><span class="co"># Farben</span></span>
<span id="cb14-2"><a href="#cb14-2"></a>WHITE  <span class="op">=</span> p5.color(<span class="dv">255</span>, <span class="dv">255</span>, <span class="dv">255</span>)</span>
<span id="cb14-3"><a href="#cb14-3"></a>BLACK  <span class="op">=</span> p5.color(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb14-4"><a href="#cb14-4"></a>BROWN  <span class="op">=</span> p5.color(<span class="dv">248</span>, <span class="dv">158</span>, <span class="dv">80</span>)</span>
<span id="cb14-5"><a href="#cb14-5"></a>GREEN  <span class="op">=</span> p5.color(<span class="dv">98</span>, <span class="dv">199</span>, <span class="dv">119</span>)</span>
<span id="cb14-6"><a href="#cb14-6"></a>YELLOW <span class="op">=</span> p5.color(<span class="dv">248</span>, <span class="dv">239</span>, <span class="dv">34</span>)</span>
<span id="cb14-7"><a href="#cb14-7"></a>PURPLE <span class="op">=</span> p5.color(<span class="dv">148</span>, <span class="dv">103</span>, <span class="dv">189</span>)</span>
<span id="cb14-8"><a href="#cb14-8"></a>RED <span class="op">=</span> p5.color(<span class="dv">250</span>, <span class="dv">25</span>, <span class="dv">25</span>)</span>
<span id="cb14-9"><a href="#cb14-9"></a>color_list <span class="op">=</span> [WHITE, RED, YELLOW, PURPLE]</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>und die Klasse <code>Sheep</code> bekommt im Konstruktor eine Farbe mit übergeben</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, _x, _y, _col):</span>
<span id="cb15-2"><a href="#cb15-2"></a>        <span class="va">self</span>.x <span class="op">=</span> _x</span>
<span id="cb15-3"><a href="#cb15-3"></a>        <span class="va">self</span>.y <span class="op">=</span> _y</span>
<span id="cb15-4"><a href="#cb15-4"></a>        <span class="va">self</span>.col <span class="op">=</span> _col</span>
<span id="cb15-5"><a href="#cb15-5"></a>        <span class="va">self</span>.size <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb15-6"><a href="#cb15-6"></a>        <span class="va">self</span>.energy <span class="op">=</span> <span class="dv">20</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>und in der Methode <code>draw()</code> als vorletzte Anweisung den Befehl</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1"></a>        p5.fill(<span class="va">self</span>.col)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>bevor sie das Schaf als Kreis zeichnen soll.</p>
<p>Nur das Hauptprogramm hat noch ein paar wesentlichere Änderungen erfahren. Erst einmal bei der Import-Anweisung:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1"></a><span class="im">from</span> random <span class="im">import</span> uniform, randint, choice</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Hier wird also zusätzlich von <code>random</code> noch die Methode <code>choice()</code> importiert, die dazu dient, aus der Liste <code>colors</code> zufällig, aber gleichverteilt die Farben herauszusuchen und an die einzelnen Schafe zu verteilen.</p>
<p>Und im <code>setup()</code> werden dann diese Farben verteilt:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1"></a><span class="kw">def</span> setup():</span>
<span id="cb18-2"><a href="#cb18-2"></a>    p5.create_canvas(WIDTH, HEIGHT)</span>
<span id="cb18-3"><a href="#cb18-3"></a>    <span class="co"># Create the sheeps</span></span>
<span id="cb18-4"><a href="#cb18-4"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(NO_SHEEPS):</span>
<span id="cb18-5"><a href="#cb18-5"></a>        sheeps.append(Sheep(randint(<span class="dv">20</span>, p5.width <span class="op">-</span> <span class="dv">20</span>),</span>
<span id="cb18-6"><a href="#cb18-6"></a>                            randint(<span class="dv">20</span>, p5.height <span class="op">-</span> <span class="dv">20</span>),</span>
<span id="cb18-7"><a href="#cb18-7"></a>                            choice(color_list)))</span>
<span id="cb18-8"><a href="#cb18-8"></a>    <span class="co"># Create the grass</span></span>
<span id="cb18-9"><a href="#cb18-9"></a>    <span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, p5.width, PATCH_SIZE):</span>
<span id="cb18-10"><a href="#cb18-10"></a>        <span class="cf">for</span> y <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, p5.height, PATCH_SIZE):</span>
<span id="cb18-11"><a href="#cb18-11"></a>            lawn.append(Grass(x, y, PATCH_SIZE))</span>
<span id="cb18-12"><a href="#cb18-12"></a>    p5.frame_rate(FPS)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Die <code>draw()</code>-Funktion habe ich nicht noch einmal abgeschrieben, da sich in ihr nichts geändert hat.</p>
<iframe src="proseco/index.html" width="100%" height="400">
</iframe>
<p>Was glaubt Ihr, was nun passiert? Zu Beginn der Simulation tummeln sich fröhlich vier Gruppen verschieden farbiger Schafe auf der Weide. Im weiteren Verlauf stirbt jedoch eine Farbe nach der anderen aus, bis nur noch eine Farbe übrigbleibt. Welche Farbe jedoch übrigbleibt, ist nicht vorhersehbar und rein zufällig. (Um nicht so lange auf das Aussterben der Populationen warten zu müssen – das kann sich manchmal lange hinziehen –, könnt Ihr die <code>frame_rate</code> auf 60 FPS erhöhen.)</p>
<p>Auch dieses Verhalten ist bekannt und wurde 1975 unter anderem von <em>Manfred Eigen</em> und <em>Ruthild Winkler</em> in ihrem Buch »Das Spiel – Naturgesetze steuern den Zufall« im Kapitel über Selektion beschrieben:</p>
<blockquote class="blockquote">
<p>Es kann mit Sicherheit bei jedem Spiel die Tatsache der Selektion vorausgesagt werden, nicht dagegen das Detailergebnis, nämlich welche Kugelfarbe selektiert wird.</p>
</blockquote>
<p>Denn mit Ausnahme der Farbe verhalten sich alle Kreise identisch, das heißt, sie sind mit dem exakt gleichen genetischen Material ausgestattet. Man kann, um die Sache nicht zu kompliziert zu machen, auch einfach annehemen, daß die Farben Markierungen sind, die vom Beobachter auf die ansonsten genetisch identischen Schafe angebracht wurden.</p>
<p>Zu einem ähnlichen Ergebnis, kam ja schon das <a href="https://kantel.github.io/posts/2025062502_waehler_tigerjython/">Demokratie-Spiel</a>, das <em>Alexander K. Dewdney</em> in der <em>Scientific American</em> beschrieben hat: Wenn man lange genug Demokratie spielt, dann gewinnt zum Schluß eine Partei alle Sitze. Nur weiß man im Voraus nicht, welche.</p>
<p>Und in einem Ökosystem, in dem zwei oder mehr exakt gleiche Räuberpopulationen um die gleiche Beute konkurrieren, stirbt über kurz oder lang eine der beiden Populationen aus. Jede Population kann nur getrennt überleben, wenn sie sich ihre eigene, ökologische Nische sucht.</p>
<p>Wenn man jedoch, und auch das haben Eigen und Winkler beschrieben, einer Population auch nur einen winzigen Vorteil verschafft, dann überlebt diese Population. Wenn Ihr nämlich in der Klasse <code>Sheep</code> in der <code>update()</code>-Methode statt der Zeile <code>move = 10</code> diese Anweisung einfügt,</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1"></a>     <span class="kw">def</span> update(<span class="va">self</span>):</span>
<span id="cb19-2"><a href="#cb19-2"></a>        <span class="cf">if</span> <span class="va">self</span>.col <span class="op">=</span> RED <span class="kw">and</span> uniform(<span class="dv">0</span>, <span class="dv">100</span>) <span class="op">&lt;</span> <span class="fl">.5</span>:</span>
<span id="cb19-3"><a href="#cb19-3"></a>            move <span class="op">=</span> <span class="dv">25</span></span>
<span id="cb19-4"><a href="#cb19-4"></a>        <span class="cf">else</span>:</span>
<span id="cb19-5"><a href="#cb19-5"></a>            move <span class="op">=</span> <span class="dv">10</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>dann überlebt <strong>immer</strong> (und zwar ziemlich schnell) die rote Population.</p>
<p>Der Vollständigkeit halber hier jetzt der komplette Quellcode in der endgültigen Fassung:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1"></a><span class="im">from</span> proceso <span class="im">import</span> Sketch</span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="im">from</span> random <span class="im">import</span> uniform, randint, choice</span>
<span id="cb20-3"><a href="#cb20-3"></a></span>
<span id="cb20-4"><a href="#cb20-4"></a>p5 <span class="op">=</span> Sketch()</span>
<span id="cb20-5"><a href="#cb20-5"></a></span>
<span id="cb20-6"><a href="#cb20-6"></a>WIDTH, HEIGHT <span class="op">=</span> (<span class="dv">640</span>, <span class="dv">400</span>)</span>
<span id="cb20-7"><a href="#cb20-7"></a>FPS <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb20-8"><a href="#cb20-8"></a>NO_SHEEPS <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb20-9"><a href="#cb20-9"></a>PATCH_SIZE <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb20-10"><a href="#cb20-10"></a></span>
<span id="cb20-11"><a href="#cb20-11"></a><span class="co"># Farben</span></span>
<span id="cb20-12"><a href="#cb20-12"></a>WHITE  <span class="op">=</span> p5.color(<span class="dv">255</span>, <span class="dv">255</span>, <span class="dv">255</span>)</span>
<span id="cb20-13"><a href="#cb20-13"></a>BLACK  <span class="op">=</span> p5.color(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb20-14"><a href="#cb20-14"></a>BROWN  <span class="op">=</span> p5.color(<span class="dv">248</span>, <span class="dv">158</span>, <span class="dv">80</span>)</span>
<span id="cb20-15"><a href="#cb20-15"></a>GREEN  <span class="op">=</span> p5.color(<span class="dv">98</span>, <span class="dv">199</span>, <span class="dv">119</span>)</span>
<span id="cb20-16"><a href="#cb20-16"></a>YELLOW <span class="op">=</span> p5.color(<span class="dv">248</span>, <span class="dv">239</span>, <span class="dv">34</span>)</span>
<span id="cb20-17"><a href="#cb20-17"></a>PURPLE <span class="op">=</span> p5.color(<span class="dv">148</span>, <span class="dv">103</span>, <span class="dv">189</span>)</span>
<span id="cb20-18"><a href="#cb20-18"></a>RED <span class="op">=</span> p5.color(<span class="dv">250</span>, <span class="dv">25</span>, <span class="dv">25</span>)</span>
<span id="cb20-19"><a href="#cb20-19"></a>color_list <span class="op">=</span> [WHITE, RED, YELLOW, PURPLE]</span>
<span id="cb20-20"><a href="#cb20-20"></a></span>
<span id="cb20-21"><a href="#cb20-21"></a><span class="kw">class</span> Sheep:</span>
<span id="cb20-22"><a href="#cb20-22"></a></span>
<span id="cb20-23"><a href="#cb20-23"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, _x, _y, _col):</span>
<span id="cb20-24"><a href="#cb20-24"></a>        <span class="va">self</span>.x <span class="op">=</span> _x</span>
<span id="cb20-25"><a href="#cb20-25"></a>        <span class="va">self</span>.y <span class="op">=</span> _y</span>
<span id="cb20-26"><a href="#cb20-26"></a>        <span class="va">self</span>.col <span class="op">=</span> _col</span>
<span id="cb20-27"><a href="#cb20-27"></a>        <span class="va">self</span>.size <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb20-28"><a href="#cb20-28"></a>        <span class="va">self</span>.energy <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb20-29"><a href="#cb20-29"></a></span>
<span id="cb20-30"><a href="#cb20-30"></a>    <span class="kw">def</span> update(<span class="va">self</span>):</span>
<span id="cb20-31"><a href="#cb20-31"></a>        move <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb20-32"><a href="#cb20-32"></a>        rows_of_grass <span class="op">=</span> p5.height<span class="op">//</span>PATCH_SIZE</span>
<span id="cb20-33"><a href="#cb20-33"></a>        <span class="va">self</span>.energy <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb20-34"><a href="#cb20-34"></a>        <span class="cf">if</span> <span class="va">self</span>.energy <span class="op">&lt;=</span> <span class="dv">0</span>:</span>
<span id="cb20-35"><a href="#cb20-35"></a>            sheeps.remove(<span class="va">self</span>)</span>
<span id="cb20-36"><a href="#cb20-36"></a>        <span class="cf">if</span> <span class="va">self</span>.energy <span class="op">&gt;=</span> <span class="dv">50</span>:</span>
<span id="cb20-37"><a href="#cb20-37"></a>            <span class="va">self</span>.energy <span class="op">-=</span> <span class="dv">30</span>   <span class="co"># Giving birth takes energy</span></span>
<span id="cb20-38"><a href="#cb20-38"></a>            <span class="co"># Add another sheep to the list</span></span>
<span id="cb20-39"><a href="#cb20-39"></a>            sheeps.append(Sheep(<span class="va">self</span>.x, <span class="va">self</span>.y, <span class="va">self</span>.col))</span>
<span id="cb20-40"><a href="#cb20-40"></a>        <span class="va">self</span>.x <span class="op">+=</span> uniform(<span class="op">-</span>move, move)</span>
<span id="cb20-41"><a href="#cb20-41"></a>        <span class="va">self</span>.y <span class="op">+=</span> uniform(<span class="op">-</span>move, move)</span>
<span id="cb20-42"><a href="#cb20-42"></a>        <span class="va">self</span>.check_border()</span>
<span id="cb20-43"><a href="#cb20-43"></a>        x_scale <span class="op">=</span> <span class="bu">int</span>(<span class="va">self</span>.x<span class="op">/</span>PATCH_SIZE)</span>
<span id="cb20-44"><a href="#cb20-44"></a>        y_scale <span class="op">=</span> <span class="bu">int</span>(<span class="va">self</span>.y<span class="op">/</span>PATCH_SIZE)</span>
<span id="cb20-45"><a href="#cb20-45"></a>        grass <span class="op">=</span> lawn[x_scale<span class="op">*</span>rows_of_grass <span class="op">+</span> y_scale]</span>
<span id="cb20-46"><a href="#cb20-46"></a>        <span class="cf">if</span> <span class="kw">not</span> grass.eaten:</span>
<span id="cb20-47"><a href="#cb20-47"></a>            <span class="va">self</span>.energy <span class="op">+=</span> grass.energy</span>
<span id="cb20-48"><a href="#cb20-48"></a>            grass.eaten <span class="op">=</span> <span class="va">True</span></span>
<span id="cb20-49"><a href="#cb20-49"></a></span>
<span id="cb20-50"><a href="#cb20-50"></a>    <span class="kw">def</span> check_border(<span class="va">self</span>):</span>
<span id="cb20-51"><a href="#cb20-51"></a>        <span class="cf">if</span> <span class="va">self</span>.x <span class="op">&gt;=</span> p5.width <span class="op">-</span> <span class="dv">2</span><span class="op">*</span><span class="va">self</span>.size:</span>
<span id="cb20-52"><a href="#cb20-52"></a>            <span class="va">self</span>.x <span class="op">=</span> p5.width <span class="op">-</span> <span class="dv">2</span><span class="op">*</span><span class="va">self</span>.size</span>
<span id="cb20-53"><a href="#cb20-53"></a>        <span class="cf">if</span> <span class="va">self</span>.y <span class="op">&gt;=</span> p5.height <span class="op">-</span> <span class="dv">2</span><span class="op">*</span><span class="va">self</span>.size:</span>
<span id="cb20-54"><a href="#cb20-54"></a>            <span class="va">self</span>.y <span class="op">=</span> p5.height <span class="op">-</span> <span class="dv">2</span><span class="op">*</span><span class="va">self</span>.size</span>
<span id="cb20-55"><a href="#cb20-55"></a>        <span class="cf">if</span> <span class="va">self</span>.x <span class="op">&lt;=</span> <span class="va">self</span>.size:</span>
<span id="cb20-56"><a href="#cb20-56"></a>            <span class="va">self</span>.x <span class="op">=</span> <span class="va">self</span>.size</span>
<span id="cb20-57"><a href="#cb20-57"></a>        <span class="cf">if</span> <span class="va">self</span>.y <span class="op">&lt;=</span> <span class="va">self</span>.size:</span>
<span id="cb20-58"><a href="#cb20-58"></a>            <span class="va">self</span>.y <span class="op">=</span> <span class="va">self</span>.size</span>
<span id="cb20-59"><a href="#cb20-59"></a>    </span>
<span id="cb20-60"><a href="#cb20-60"></a>    <span class="kw">def</span> draw(<span class="va">self</span>):</span>
<span id="cb20-61"><a href="#cb20-61"></a>        p5.stroke_weight(<span class="dv">1</span>)</span>
<span id="cb20-62"><a href="#cb20-62"></a>        p5.stroke(BLACK)</span>
<span id="cb20-63"><a href="#cb20-63"></a>        p5.fill(<span class="va">self</span>.col)</span>
<span id="cb20-64"><a href="#cb20-64"></a>        p5.circle(<span class="va">self</span>.x, <span class="va">self</span>.y, <span class="va">self</span>.size)</span>
<span id="cb20-65"><a href="#cb20-65"></a></span>
<span id="cb20-66"><a href="#cb20-66"></a><span class="kw">class</span> Grass:</span>
<span id="cb20-67"><a href="#cb20-67"></a></span>
<span id="cb20-68"><a href="#cb20-68"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, _x, _y, _size):</span>
<span id="cb20-69"><a href="#cb20-69"></a>        <span class="va">self</span>.x <span class="op">=</span> _x</span>
<span id="cb20-70"><a href="#cb20-70"></a>        <span class="va">self</span>.y <span class="op">=</span> _y</span>
<span id="cb20-71"><a href="#cb20-71"></a>        <span class="va">self</span>.energy <span class="op">=</span> <span class="dv">5</span>      <span class="co"># Energy from eating this patch</span></span>
<span id="cb20-72"><a href="#cb20-72"></a>        <span class="va">self</span>.eaten <span class="op">=</span> <span class="va">False</span>   <span class="co"># Hasn't been eaten yet</span></span>
<span id="cb20-73"><a href="#cb20-73"></a>        <span class="va">self</span>.size <span class="op">=</span> _size</span>
<span id="cb20-74"><a href="#cb20-74"></a>    </span>
<span id="cb20-75"><a href="#cb20-75"></a>    <span class="kw">def</span> draw(<span class="va">self</span>):</span>
<span id="cb20-76"><a href="#cb20-76"></a>        p5.no_stroke()</span>
<span id="cb20-77"><a href="#cb20-77"></a>        <span class="cf">if</span> <span class="va">self</span>.eaten:</span>
<span id="cb20-78"><a href="#cb20-78"></a>            <span class="cf">if</span> uniform(<span class="dv">0</span>, <span class="dv">100</span>) <span class="op">&lt;</span> <span class="fl">.5</span>:</span>
<span id="cb20-79"><a href="#cb20-79"></a>                <span class="va">self</span>.eaten <span class="op">=</span> <span class="va">False</span></span>
<span id="cb20-80"><a href="#cb20-80"></a>            <span class="cf">else</span>:</span>
<span id="cb20-81"><a href="#cb20-81"></a>                p5.fill(BROWN)</span>
<span id="cb20-82"><a href="#cb20-82"></a>        <span class="cf">else</span>:</span>
<span id="cb20-83"><a href="#cb20-83"></a>            p5.fill(GREEN)</span>
<span id="cb20-84"><a href="#cb20-84"></a>        p5.rect(<span class="va">self</span>.x, <span class="va">self</span>.y, <span class="va">self</span>.size, <span class="va">self</span>.size)</span>
<span id="cb20-85"><a href="#cb20-85"></a></span>
<span id="cb20-86"><a href="#cb20-86"></a>sheeps <span class="op">=</span> []</span>
<span id="cb20-87"><a href="#cb20-87"></a>lawn <span class="op">=</span> []</span>
<span id="cb20-88"><a href="#cb20-88"></a></span>
<span id="cb20-89"><a href="#cb20-89"></a><span class="kw">def</span> setup():</span>
<span id="cb20-90"><a href="#cb20-90"></a>    p5.create_canvas(WIDTH, HEIGHT)</span>
<span id="cb20-91"><a href="#cb20-91"></a>    <span class="co"># Create the sheeps</span></span>
<span id="cb20-92"><a href="#cb20-92"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(NO_SHEEPS):</span>
<span id="cb20-93"><a href="#cb20-93"></a>        sheeps.append(Sheep(randint(<span class="dv">20</span>, p5.width <span class="op">-</span> <span class="dv">20</span>),</span>
<span id="cb20-94"><a href="#cb20-94"></a>                            randint(<span class="dv">20</span>, p5.height <span class="op">-</span> <span class="dv">20</span>),</span>
<span id="cb20-95"><a href="#cb20-95"></a>                            choice(color_list)))</span>
<span id="cb20-96"><a href="#cb20-96"></a>    <span class="co"># Create the grass</span></span>
<span id="cb20-97"><a href="#cb20-97"></a>    <span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, p5.width, PATCH_SIZE):</span>
<span id="cb20-98"><a href="#cb20-98"></a>        <span class="cf">for</span> y <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, p5.height, PATCH_SIZE):</span>
<span id="cb20-99"><a href="#cb20-99"></a>            lawn.append(Grass(x, y, PATCH_SIZE))</span>
<span id="cb20-100"><a href="#cb20-100"></a>    p5.frame_rate(FPS)</span>
<span id="cb20-101"><a href="#cb20-101"></a></span>
<span id="cb20-102"><a href="#cb20-102"></a><span class="kw">def</span> draw():</span>
<span id="cb20-103"><a href="#cb20-103"></a>    p5.background(GREEN)</span>
<span id="cb20-104"><a href="#cb20-104"></a>    <span class="co"># Update the grass first</span></span>
<span id="cb20-105"><a href="#cb20-105"></a>    <span class="cf">for</span> grass <span class="kw">in</span> lawn:</span>
<span id="cb20-106"><a href="#cb20-106"></a>        grass.draw()</span>
<span id="cb20-107"><a href="#cb20-107"></a>    <span class="co"># then the sheeps    </span></span>
<span id="cb20-108"><a href="#cb20-108"></a>    <span class="cf">for</span> sheep <span class="kw">in</span> sheeps:</span>
<span id="cb20-109"><a href="#cb20-109"></a>        sheep.update()</span>
<span id="cb20-110"><a href="#cb20-110"></a>        sheep.draw()</span>
<span id="cb20-111"><a href="#cb20-111"></a></span>
<span id="cb20-112"><a href="#cb20-112"></a>p5.run_sketch(setup<span class="op">=</span>setup, draw<span class="op">=</span>draw)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Ihr könnt natürlich noch weiter an den Parametern schrauben, um vielleicht noch weitere Einsichten aus dieser einfachen Simulation zu gewinnen. Eine Möglichkeit wäre, die Lebenszeit der Schafe zu begrenzen. Sie könnten mit 255 Lebenspunkten anfangen und bei jedem Durchlauf wird ihnen davon etwas abgezogen. Sie »sterben«, wenn Ihre Lebenspunkte auf Null oder unter Null gefallen sind.</p>
<p>Interessant wäre dann, herauszufinden, ob und wie sich unterschiedliche Lebensspannen auf die Überlebenschancen der Populationen auswirken. Ihr seht, selbst so eine einfache und kleine Simulation kann einen lange beschäftigen.</p>
</section>
<section id="benutzte-und-weiterführende-literatur" class="level2">
<h2 class="anchored" data-anchor-id="benutzte-und-weiterführende-literatur">Benutzte und weiterführende Literatur</h2>
<ul>
<li>A.K. Dewdney: <em>Wie man π erschießt. Fünf leichte Stücke für WHILE-Schleifen und Zufallsgenerator, oder: lebensechte Simulationen von Zombies, Wählern und Warteschlangen</em>, in: Immo Diener (Hg.): <em>Computer-Kurzweil</em>, Heidelberg (Spektrum der Wissenschaft, Reihe: Verständliche Forschung) 1988</li>
<li>Manfred Eigen, Ruthild Winkler: <em>Das Spiel. Naturgesetze steuern den Zufall</em>, München (Piper), 1975 (unveränderte Taschenbuchausgabe 1985)</li>
<li>Peter Farrell: <em>Math Adventures with Python. An Illustrated Guide to Exploring Math with Code</em>, San Francisco CA (No Starch Press) 2019</li>
<li>Mitchel Resnick: <em>Turtles, Termites, and Traffic Jams – Explorations in Massively Parallel Microworlds</em>, Cambridge MA (MIT Press) 1994 (unveränderte Paperback-Ausgabe 1997)</li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Kopiert");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Kopiert");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/kantel\.github\.io\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="kantel/kantel.github.io" data-repo-id="R_kgDOIjiXMQ" data-category="General" data-category-id="DIC_kwDOIjiXMc4CS_hh" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script>
<input type="hidden" id="giscus-base-theme" value="light">
<input type="hidden" id="giscus-alt-theme" value="dark">
</div> <!-- /content -->




</body></html>